{
  "name": "K&S-Media-Downloadliste",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -1360,
        200
      ],
      "id": "5b2c11ca-33cb-4c56-a639-596edb7cd46d",
      "name": "When clicking ‘Test workflow’"
    },
    {
      "parameters": {
        "url": "https://google.serper.dev/search",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "q",
              "value": "=Company {{ $('Loop Over Items').first().json.Company }} at {{ $('Loop Over Items').first().json.Address.match(/,\\s*(.*)/)[1] }} {{ $('Loop Over Items').first().json.Country }}\n"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "X-API-KEY",
              "value": "4ff0d5d9bf4ba4ca7779a75c034f12fbf1fd8e92"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2140,
        1520
      ],
      "id": "0cb900a8-a8f7-4fa8-aa2c-583f86099017",
      "name": "HTTP Request"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        840,
        2260
      ],
      "id": "94d69ae4-9f71-46e7-bf7f-00e10c7ac9d0",
      "name": "Loop Over Items"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "Replace Me",
      "typeVersion": 1,
      "position": [
        5720,
        2280
      ],
      "id": "09254ac8-b329-45c3-bcb9-1ef88e2933c1"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Company {{ $('Loop Over Items').first().json.Company }} in {{ $('Loop Over Items').first().json['Form-Language'] }} {{ $('Loop Over Items').first().json.Country }} does {{ $json.output }} ",
        "options": {
          "systemMessage": "Du bist ein hochqualifizierter Firmenklassifizierer und Rechercheur mit Zugriff auf zuverlässige Datenquellen.\nDeine Aufgabe ist es, ein Unternehmen anhand des Firmennamens und einer kurzen Tätigkeitsbeschreibung kontextbezogen zu bewerten.\n\nZu berücksichtigende Branchen\n\nAkustik (Raumakustik, Schalldämmung, Beschallungstechnik, Audio)\nBüro (Büroplanung, Büromöbel, Büro‑Trennwände, Drucker, Druckerverleih, Bürostühle, Bürotische, Büro‑IT)\nName als Indikator\n\nEgal, ob Dienstleistung, Produkt, Entwicklung, Verkauf, Vermietung oder Beratung – zählt nur, ob das Hauptgeschäft ausschließlich oder hauptsächlich in einer oder beiden dieser Branchen liegt.\n\nEnthält der Firmenname ausschließlich Keywords aus Akustik oder Bürobranche (z. B. „Büroplaner GmbH“, „Akustikmeister GmbH“), wertet das stark für 1.\nVerknüpft der Name Zielbranchen mit anderen Bereichen (z. B. „Akustik und Fitnessgeräte GmbH“), gilt das als 0.\nFehlen im Namen Treffer, bewerte nur anhand der Tätigkeitsbeschreibung.\nEntscheidungsregeln\n\n1, wenn Name und/oder jede genannte Tätigkeit ausschließlich oder überwiegend zu Akustik und/oder Büro­branche gehört.\n0, sobald Name oder mindestens eine Tätigkeit klar nicht dazugehört (z. B. Schultische, Fußballklamotten, Festivaltechnik).\n1, wenn Tätigkeiten unklar sind, aber eindeutige Keywords aus Zielbranchen vorliegen und der Name nicht widerspricht.\n0, wenn es sich lediglich um einen normalen Möbelhändler ohne spezifischen Büro­bezug handelt.\nWichtig\n\nVerstehe Zusammenhänge: „Druckerverleih“ zählt zu Bürobranche; „Schultische“ nicht.\nBeurteile ganzheitlich: Name + Beschreibung müssen passen.\nGib nur den Integer 0 oder 1 zurück – keine Erklärungen, Kommentare oder zusätzlichen Text.\nInput\n– Firmenname\n– Tätigkeitsbeschreibung (Liste, z. B. „Büromöbelverkauf, Druckerverleih, Raumakustik-Planung“)\n\nOutput\n\n0 oder 1"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        2700,
        1520
      ],
      "id": "9dcd049f-03ba-472c-b30b-da494b0ae8aa",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI",
          "mode": "list",
          "cachedResultName": "K&S-Automation-Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1135880709,
          "mode": "list",
          "cachedResultName": "RowsToDelete",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit#gid=1135880709"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "User-IP": "={{ $('Loop Over Items').first().json['User-IP'] }}",
            "Date": "={{ $('Loop Over Items').first().json.Date }}",
            "Time": "={{ $('Loop Over Items').first().json.Time }}",
            "Form-Language": "={{ $('Loop Over Items').first().json['Form-Language'] }}",
            "First name": "={{ $('Loop Over Items').first().json['First name'] }}",
            "Salutation": "={{ $('Loop Over Items').first().json.Salutation }}",
            "Name": "={{ $('Loop Over Items').first().json.Name }}",
            "Company": "={{ $('Loop Over Items').first().json.Company }}",
            "Address": "={{ $('Loop Over Items').first().json.Address }}",
            "Country": "={{ $('Loop Over Items').first().json.Country }}",
            "E-Mail": "={{ $('Loop Over Items').first().json['E-Mail'] }}",
            "Newsletter": "={{ $('Loop Over Items').first().json.Newsletter }}",
            "How did you become attentive on the pCon.planner": "={{ $('Loop Over Items').first().json['How did you become attentive on the pCon.planner'] }}",
            "I use the pCon.planner as": "={{ $('Loop Over Items').first().json['I use the pCon.planner as'] }}",
            "Version": "={{ $('Loop Over Items').first().json.Version }}",
            "Edition": "={{ $('Loop Over Items').first().json.Edition }}",
            "branche": "={{ $('AI Agent1').first().json.output }}"
          },
          "matchingColumns": [
            "User-IP"
          ],
          "schema": [
            {
              "id": "Date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Time",
              "displayName": "Time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "User-IP",
              "displayName": "User-IP",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Form-Language",
              "displayName": "Form-Language",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Salutation",
              "displayName": "Salutation",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "First name",
              "displayName": "First name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Company",
              "displayName": "Company",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Address",
              "displayName": "Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Country",
              "displayName": "Country",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "E-Mail",
              "displayName": "E-Mail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Newsletter",
              "displayName": "Newsletter",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "How did you become attentive on the pCon.planner",
              "displayName": "How did you become attentive on the pCon.planner",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "I use the pCon.planner as",
              "displayName": "I use the pCon.planner as",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Version",
              "displayName": "Version",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Edition",
              "displayName": "Edition",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "branche",
              "displayName": "branche",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        4500,
        1500
      ],
      "id": "17237929-e662-4b20-b377-7cd53e5798df",
      "name": "Google Sheets1",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Pld7csTWl31TEr2y",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Company {{ $('Loop Over Items').first().json.Company }} in {{ $('Loop Over Items').first().json['Form-Language'] }} {{ $('Loop Over Items').first().json.Country }}is a {{ $json.knowledgeGraph.type }} {{ $json.organic[0].snippet }} {{ $json.organic[2].snippet }} ",
        "options": {
          "systemMessage": "Du bist ein hochqualifizierter Firmenklassifizierer und Rechercheur mit Zugriff auf zuverlässige Datenquellen.\nDeine Aufgabe ist es, ein Unternehmen anhand des Firmennamens und einer kurzen Tätigkeitsbeschreibung präzise zu analysieren.\n\nAnleitung:\n\nNutze sowohl Firmennamen als auch Tätigkeitsbeschreibung, um die tatsächlichen Kerntätigkeiten zu ermitteln.\nGib so viele der wichtigsten Tätigkeiten aus, wie tatsächlich vorhanden sind (mindestens 2, maximal 5).\nFormuliere jede Tätigkeit als Stichpunkt mit 3–5 Wörtern.\nKeine Branchenbezeichnungen, Einordnungen, Erklärungen oder Zusatzinfos.\nKeine Wiederholungen oder Synonyme.\nDie Ausgabe ist eine durch Kommas getrennte Liste der Stichpunkte.\nBeispielausgaben:\n\n„Büromöbelverkauf, Festivalorganisation, Hörgeräteanpassung, Grafikdesign, Immobilienvermittlung“\n„Hörgeräteberatung, Schalldämmungssysteme, Konferenzmikrofontechnik“\n„Ergonomische Bürostühle, Akustikdeckenmontage, Schulmöbelproduktion“"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        2340,
        1520
      ],
      "id": "cb2e529e-49f0-4e37-9dd9-913d9b9d2fe0",
      "name": "AI Agent1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "df41ef12-68ad-48d2-9ab4-6a7423818213",
              "leftValue": "={{ $('AI Agent').first().json.output }}",
              "rightValue": "1",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        3280,
        1520
      ],
      "id": "3ae39a0e-f86b-494e-b76b-11593eb125e1",
      "name": "If1"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI",
          "mode": "list",
          "cachedResultName": "K&S-Automation-Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 211066673,
          "mode": "list",
          "cachedResultName": "Tabellenblatt1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit#gid=211066673"
        },
        "options": {
          "returnFirstMatch": true
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        560,
        2260
      ],
      "id": "ece027b1-4e40-4799-aa27-e57601bd0d9b",
      "name": "Google Sheets3",
      "alwaysOutputData": false,
      "executeOnce": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Pld7csTWl31TEr2y",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "content": "# Is critical branche",
        "height": 2220,
        "width": 6680,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -60,
        1060
      ],
      "typeVersion": 1,
      "id": "341e2c2e-ad54-49c1-8c47-4c6daaf5c928",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "url": "https://google.serper.dev/search",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "q",
              "value": "={{ $('Loop Over Items3').first().json.Company }} at {{ $('Loop Over Items3').first().json.Address.match(/,\\s*(.*)/)[1] }} telefonnummer {{ $('Loop Over Items3').first().json.Country }}\n"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "X-API-KEY",
              "value": "4ff0d5d9bf4ba4ca7779a75c034f12fbf1fd8e92"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2880,
        3440
      ],
      "id": "2815f476-ff9c-4382-93fc-13b2732941ec",
      "name": "HTTP Request1"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        840,
        3660
      ],
      "id": "0fada3a7-128b-4793-b98a-ef0299c65368",
      "name": "Loop Over Items3"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "Replace Me3",
      "typeVersion": 1,
      "position": [
        6220,
        3640
      ],
      "id": "bdf864b5-12ac-46c5-82fc-09b20f1e5e1a"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4o-mini",
          "mode": "list",
          "cachedResultName": "gpt-4o-mini"
        },
        "options": {
          "temperature": 0
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        3480,
        4200
      ],
      "id": "6d212a7f-690f-4cf2-ac13-d230c5542b79",
      "name": "OpenAI Chat Model1",
      "credentials": {
        "openAiApi": {
          "id": "F4TTzvzjjYGqOAGL",
          "name": "KS-Media"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI",
          "mode": "list",
          "cachedResultName": "K&S-Automation-Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 211066673,
          "mode": "list",
          "cachedResultName": "Tabellenblatt1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit#gid=211066673"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": "={{ $('Loop Over Items3').first().json.row_number}}",
            "CompanyPhone": "={{ JSON.stringify($('AI Agent4').first().json.output) }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "Date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Time",
              "displayName": "Time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "User-IP",
              "displayName": "User-IP",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Form-Language",
              "displayName": "Form-Language",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Salutation",
              "displayName": "Salutation",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "First name",
              "displayName": "First name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Company",
              "displayName": "Company",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Address",
              "displayName": "Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Country",
              "displayName": "Country",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "E-Mail",
              "displayName": "E-Mail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Newsletter",
              "displayName": "Newsletter",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "How did you become attentive on the pCon.planner",
              "displayName": "How did you become attentive on the pCon.planner",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "I use the pCon.planner as",
              "displayName": "I use the pCon.planner as",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Version",
              "displayName": "Version",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Edition",
              "displayName": "Edition",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "CompanyPhone",
              "displayName": "CompanyPhone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        4700,
        3820
      ],
      "id": "49d33f35-f0a7-44e1-8dab-0f2df51aaaa3",
      "name": "Google Sheets9",
      "executeOnce": true,
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Pld7csTWl31TEr2y",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.answerBox.title }} {{ $json.answerBox.answer }};;; {{ $json.organic[0].title }}{{ $json.organic[0].snippet }};;;{{ $json.organic[2].title }}{{ $json.organic[2].snippet }};;;{{ $json.organic[3].title }}{{ $json.organic[3].snippet }};;;",
        "options": {
          "systemMessage": "=Du bist ein spezialisierter Filter für Telefonnummern von Firmen. Deine Aufgabe ist es, die Telefonnummer der Firma {{ $('Loop Over Items3').first().json.Company }} in {{ $('Loop Over Items3')?.first()?.json.Address && $('Loop Over Items3')?.first()?.json.Address.match(/,\\s*(.*)/) ? $('Loop Over Items3')?.first()?.json.Address.match(/,\\s*(.*)/)[1] : '' }}\n {{ $('Loop Over Items3').first().json.Country }} aus den gegebenen Suchergebnissen zu extrahieren. \n\n## Regeln:\n1. Die Suchergebnisse sind durch `;;;` getrennt.\n2. Gib nur die Telefonnummer aus dem ersten Ergebnis zurück, falls sie vorhanden ist. Falls im ersten Ergebnis keine gültige Telefonnummer enthalten ist, suche im zweiten.\n3. Stelle sicher, dass die gefundene Telefonnummer auch wirklich der Firma {{ $('Loop Over Items3').item.json.Company }} in {{ $('Loop Over Items3')?.item?.json.Address && $('Loop Over Items3')?.item?.json.Address.match(/,\\s*(.*)/) ? $('Loop Over Items3')?.item?.json.Address.match(/,\\s*(.*)/)[1] : '' }}\n {{ $('Loop Over Items3').item.json.Country }} zugeordnet ist. Achte besonders darauf, dass die Telefonnummer aus einer verlässlichen Quelle stammt und der Firma zugeordnet werden kann.\n4. Wenn keine gültige Telefonnummer gefunden wird, gib none zurück.\n\nGib nur die Telefonnummer zurück mit zwei einzigen kurzen worten das beschreibt wo du sie gefunden hast und zu wem sie gehört. Wenn du dazu keine Information hast schreibe \"allgemein\". Keine weiteren Informationen. z.B.\nAnna Schuhmann: +49 44040033003\nallgemein: 40400404\n\nwenn du keine passende Telefonnummer findest gebe nur none zurrück und sonst nichts "
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        3220,
        3440
      ],
      "id": "0062e306-d531-4a24-a374-d0840e70fc10",
      "name": "AI Agent3",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "df41ef12-68ad-48d2-9ab4-6a7423818213",
              "leftValue": "={{ $json.output }}",
              "rightValue": "none",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        3780,
        3440
      ],
      "id": "8820bfc8-5c52-434f-a004-eef41693d3ea",
      "name": "If3"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI",
          "mode": "list",
          "cachedResultName": "K&S-Automation-Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 211066673,
          "mode": "list",
          "cachedResultName": "Tabellenblatt1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit#gid=211066673"
        },
        "options": {
          "returnFirstMatch": true
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        560,
        3680
      ],
      "id": "df7d4185-028b-4557-a15e-4c0fdc8accd7",
      "name": "Google Sheets11",
      "executeOnce": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Pld7csTWl31TEr2y",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "content": "# Find company phonenumber\n",
        "height": 1220,
        "width": 6700,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -60,
        3260
      ],
      "typeVersion": 1,
      "id": "9cae416e-b7b1-42d1-aa45-94b92039c66b",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Code1').first().json.cleanedText }}\n",
        "options": {
          "systemMessage": "=Suche hier die telefonnummer raus und Gib nur die Telefonnummer zurück mit zwei einzigen kurzen worten das beschreibt wo du sie gefunden hast und zu wem sie gehört. Wenn du dazu keine Information hast schreibe \"allgemein\". Keine weiteren Informationen. z.B.\nAnna Schuhmann: +49 44040033003\nallgemein: 40400404\n\nwenn du keine passende Telefonnummer findest gebe nur none zurrück und sonst nichts "
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        3740,
        3700
      ],
      "id": "4134d1af-ec58-4df1-aabb-7eaa45781af1",
      "name": "AI Agent4",
      "alwaysOutputData": false,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "df41ef12-68ad-48d2-9ab4-6a7423818213",
              "leftValue": "={{ $json.output }}",
              "rightValue": "none",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        4220,
        3700
      ],
      "id": "50093ecc-0961-47d2-b7c1-70deac76f028",
      "name": "If4"
    },
    {
      "parameters": {
        "url": "={{ $('Loop Over Items3').first().json['E-Mail'] ? \"http://www.\" + $('Loop Over Items3').first().json['E-Mail'].split(\"@\")[1] : '' }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2840,
        3720
      ],
      "id": "84de807c-0b41-4e26-b090-e774f56f3d24",
      "name": "HTTP Request3",
      "alwaysOutputData": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "url": "={{ $('Loop Over Items3').first().json['E-Mail'] ? \"http://www.\" + $('Loop Over Items3').first().json['E-Mail'].split(\"@\")[1] + \"/impressum\" : '' }}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        3060,
        3720
      ],
      "id": "991f8dcd-3270-48d9-a9c8-a80ca3ac155a",
      "name": "HTTP Request2",
      "alwaysOutputData": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "6c478565-ae01-4b2d-878f-b2f53ce7d86a",
              "leftValue": "={{ $('Loop Over Items3').first().json['E-Mail'].toString() }}",
              "rightValue": "^[\\w\\.-]+@(gmail|t\\-online|cloud|ooglemail|test|googlemail|yahoo|ymail|rocketmail|hotmail|outlook|live|msn|icloud|me|mac|aol|mail|zoho|gmx|web|t-online|freenet|email|arcor|vodafone|alice|versanet|kabelmail|online|ewetel|protonmail|proton|tutanota|posteo|runbox|mailfence|startmail|fastmail|hushmail|mailbox|bluewin|sunrise|swissonline|hispeed|laposte|libero|tin|seznam|mail\\.ru|yandex|inbox\\.ru|bk\\.ru|list\\.ru|qq|126|163|sina|naver|daum|gawab|cox|comcast|bellsouth|verizon|berlin|aon|inode|chello|utanet|tele2|eduhi|liwest|netcologne|example|seml|mailinator|pm|clonemailsieure|anonymous|duck)\\.[a-zA-Z]{2,}$",
              "operator": {
                "type": "string",
                "operation": "regex"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2260,
        3660
      ],
      "id": "dfc8eaf1-f7ff-4f58-ae5e-f0cdc8a9dad5",
      "name": "isEmailPrivat1"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "Replace Me4",
      "typeVersion": 1,
      "position": [
        6560,
        6520
      ],
      "id": "b7043b25-2bf5-47df-befb-438492b7fb4b"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI",
          "mode": "list",
          "cachedResultName": "K&S-Automation-Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 211066673,
          "mode": "list",
          "cachedResultName": "Tabellenblatt1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit#gid=211066673"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        460,
        6540
      ],
      "id": "fbf1010e-4224-44f4-9cd8-a5274d862f7b",
      "name": "Google Sheets15",
      "alwaysOutputData": false,
      "executeOnce": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Pld7csTWl31TEr2y",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "6c478565-ae01-4b2d-878f-b2f53ce7d86a",
              "leftValue": "={{ $('Loop Over Items4').first().json.CompanyPhone }}",
              "rightValue": "\"allgemein: allgemein\"",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2320,
        6540
      ],
      "id": "ec4219e2-5843-4c22-a412-c73a877bdfd7",
      "name": "isEmailPrivat2"
    },
    {
      "parameters": {
        "options": {
          "reset": false
        }
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        740,
        6540
      ],
      "id": "7a9a7b03-70cd-471f-913c-22c23994d12b",
      "name": "Loop Over Items4"
    },
    {
      "parameters": {
        "url": "https://google.serper.dev/search",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "q",
              "value": "={{ \n  $('Loop Over Items').first().json['E-Mail'] \n    ? $('Loop Over Items').first().json['E-Mail'].split(\"@\")[1] \n    : '' \n}} {{ (() => {\n    const raw = $('Loop Over Items').first().json?.Address || '';\n    const match = raw.match(/\\b\\d{5}\\b/);\n    return match ? match[0] : '';\n  })() \n}}  {{ $('Loop Over Items').first().json.Country }}\n"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "X-API-KEY",
              "value": "4ff0d5d9bf4ba4ca7779a75c034f12fbf1fd8e92"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2480,
        1860
      ],
      "id": "b3c260d3-8ac6-4264-a833-5b8f15d992b1",
      "name": "HTTP Request6"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Company {{ \n  $('Loop Over Items').first().json['E-Mail'] \n    ? $('Loop Over Items').first().json['E-Mail'].split(\"@\")[1] \n    : '' \n}}  in {{ $('Loop Over Items').first().json['Form-Language'] }} {{ $('Loop Over Items').first().json.Country }} does {{ $json.output }} ",
        "options": {
          "systemMessage": "Du bist ein hochqualifizierter Firmenklassifizierer und Rechercheur mit Zugriff auf zuverlässige Datenquellen.\nDeine Aufgabe ist es, ein Unternehmen anhand des Firmennamens und einer kurzen Tätigkeitsbeschreibung kontextbezogen zu bewerten.\n\nZu berücksichtigende Branchen\n\nAkustik (Raumakustik, Schalldämmung, Beschallungstechnik, Audio)\nBüro (Büroplanung, Büromöbel, Büro‑Trennwände, Drucker, Druckerverleih, Bürostühle, Bürotische, Büro‑IT)\nName als Indikator\n\nEgal, ob Dienstleistung, Produkt, Entwicklung, Verkauf, Vermietung oder Beratung – zählt nur, ob das Hauptgeschäft ausschließlich oder hauptsächlich in einer oder beiden dieser Branchen liegt.\n\nEnthält der Firmenname ausschließlich Keywords aus Akustik oder Bürobranche (z. B. „Büroplaner GmbH“, „Akustikmeister GmbH“), wertet das stark für 1.\nVerknüpft der Name Zielbranchen mit anderen Bereichen (z. B. „Akustik und Fitnessgeräte GmbH“), gilt das als 0.\nFehlen im Namen Treffer, bewerte nur anhand der Tätigkeitsbeschreibung.\nEntscheidungsregeln\n\n1, wenn Name und/oder jede genannte Tätigkeit ausschließlich oder überwiegend zu Akustik und/oder Büro­branche gehört.\n0, sobald Name oder mindestens eine Tätigkeit klar nicht dazugehört (z. B. Schultische, Fußballklamotten, Festivaltechnik).\n1, wenn Tätigkeiten unklar sind, aber eindeutige Keywords aus Zielbranchen vorliegen und der Name nicht widerspricht.\n0, wenn es sich lediglich um einen normalen Möbelhändler ohne spezifischen Büro­bezug handelt.\nWichtig\n\nVerstehe Zusammenhänge: „Druckerverleih“ zählt zu Bürobranche; „Schultische“ nicht.\nBeurteile ganzheitlich: Name + Beschreibung müssen passen.\nGib nur den Integer 0 oder 1 zurück – keine Erklärungen, Kommentare oder zusätzlichen Text.\nInput\n– Firmenname\n– Tätigkeitsbeschreibung (Liste, z. B. „Büromöbelverkauf, Druckerverleih, Raumakustik-Planung“)\n\nOutput\n\n0 oder 1"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        3040,
        1860
      ],
      "id": "7db7e9bb-5fcb-4ef7-8cc8-5103cd7f8ba0",
      "name": "AI Agent2"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI",
          "mode": "list",
          "cachedResultName": "K&S-Automation-Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1135880709,
          "mode": "list",
          "cachedResultName": "RowsToDelete",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit#gid=1135880709"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "User-IP": "={{ $('Loop Over Items').first().json['User-IP'] }}",
            "Date": "={{ $('Loop Over Items').first().json.Date }}",
            "Time": "={{ $('Loop Over Items').first().json.Time }}",
            "Form-Language": "={{ $('Loop Over Items').first().json['Form-Language'] }}",
            "First name": "={{ $('Loop Over Items').first().json['First name'] }}",
            "Salutation": "={{ $('Loop Over Items').first().json.Salutation }}",
            "Name": "={{ $('Loop Over Items').first().json.Name }}",
            "Company": "={{ $('Loop Over Items').first().json.Company }}",
            "Address": "={{ $('Loop Over Items').first().json.Address }}",
            "Country": "={{ $('Loop Over Items').first().json.Country }}",
            "E-Mail": "={{ $('Loop Over Items').first().json['E-Mail'] }}",
            "Newsletter": "={{ $('Loop Over Items').first().json.Newsletter }}",
            "How did you become attentive on the pCon.planner": "={{ $('Loop Over Items').first().json['How did you become attentive on the pCon.planner'] }}",
            "I use the pCon.planner as": "={{ $('Loop Over Items').first().json['I use the pCon.planner as'] }}",
            "Version": "={{ $('Loop Over Items').first().json.Version }}",
            "Edition": "={{ $('Loop Over Items').first().json.Edition }}",
            "branche": "={{ $('AI Agent9').first().json.output }}"
          },
          "matchingColumns": [
            "User-IP"
          ],
          "schema": [
            {
              "id": "Date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Time",
              "displayName": "Time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "User-IP",
              "displayName": "User-IP",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Form-Language",
              "displayName": "Form-Language",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Salutation",
              "displayName": "Salutation",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "First name",
              "displayName": "First name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Company",
              "displayName": "Company",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Address",
              "displayName": "Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Country",
              "displayName": "Country",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "E-Mail",
              "displayName": "E-Mail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Newsletter",
              "displayName": "Newsletter",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "How did you become attentive on the pCon.planner",
              "displayName": "How did you become attentive on the pCon.planner",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "I use the pCon.planner as",
              "displayName": "I use the pCon.planner as",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Version",
              "displayName": "Version",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Edition",
              "displayName": "Edition",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "branche",
              "displayName": "branche",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        4880,
        1860
      ],
      "id": "927b22c9-43b3-4e1e-820a-c71b80d3621d",
      "name": "Google Sheets14",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Pld7csTWl31TEr2y",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Company {{ \n  $('Loop Over Items').first().json['E-Mail'] \n    ? $('Loop Over Items').first().json['E-Mail'].split(\"@\")[1] \n    : '' \n}}  in {{ $('Loop Over Items').first().json['Form-Language'] }} {{ $('Loop Over Items').first().json.Country }}is a {{ $json.knowledgeGraph.type }} {{ $json.organic[0].snippet }} {{ $json.organic[2].snippet }} ",
        "options": {
          "systemMessage": "Du bist ein hochqualifizierter Firmenklassifizierer und Rechercheur mit Zugriff auf zuverlässige Datenquellen.\nDeine Aufgabe ist es, ein Unternehmen anhand des Firmennamens und einer kurzen Tätigkeitsbeschreibung präzise zu analysieren.\n\nAnleitung:\n\nNutze sowohl Firmennamen als auch Tätigkeitsbeschreibung, um die tatsächlichen Kerntätigkeiten zu ermitteln.\nGib so viele der wichtigsten Tätigkeiten aus, wie tatsächlich vorhanden sind (mindestens 2, maximal 5).\nFormuliere jede Tätigkeit als Stichpunkt mit 3–5 Wörtern.\nKeine Branchenbezeichnungen, Einordnungen, Erklärungen oder Zusatzinfos.\nKeine Wiederholungen oder Synonyme.\nDie Ausgabe ist eine durch Kommas getrennte Liste der Stichpunkte.\nBeispielausgaben:\n\n„Büromöbelverkauf, Festivalorganisation, Hörgeräteanpassung, Grafikdesign, Immobilienvermittlung“\n„Hörgeräteberatung, Schalldämmungssysteme, Konferenzmikrofontechnik“\n„Ergonomische Bürostühle, Akustikdeckenmontage, Schulmöbelproduktion“"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        2680,
        1860
      ],
      "id": "b4cb4ceb-019b-47ea-a007-fa0b0d2a05bb",
      "name": "AI Agent9"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "df41ef12-68ad-48d2-9ab4-6a7423818213",
              "leftValue": "={{ $('AI Agent2').first().json.output }}",
              "rightValue": "1",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        3380,
        1860
      ],
      "id": "c0e90146-dd02-4154-b773-ddd902aa376e",
      "name": "If9"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4o-mini",
          "mode": "list",
          "cachedResultName": "gpt-4o-mini"
        },
        "options": {
          "temperature": 0
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        3540,
        6380
      ],
      "id": "f05316de-27fa-44a3-ac64-847f3fe1e2e6",
      "name": "OpenAI Chat Model3",
      "credentials": {
        "openAiApi": {
          "id": "F4TTzvzjjYGqOAGL",
          "name": "KS-Media"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI",
          "mode": "list",
          "cachedResultName": "K&S-Automation-Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 211066673,
          "mode": "list",
          "cachedResultName": "Tabellenblatt1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit#gid=211066673"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": "={{ $('Loop Over Items4').first().json.row_number}}",
            "CompanyPhone": "={{ JSON.stringify($('AI Agent10').first().json.output) }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "Date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Time",
              "displayName": "Time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "User-IP",
              "displayName": "User-IP",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Form-Language",
              "displayName": "Form-Language",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Salutation",
              "displayName": "Salutation",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "First name",
              "displayName": "First name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Company",
              "displayName": "Company",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Address",
              "displayName": "Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Country",
              "displayName": "Country",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "E-Mail",
              "displayName": "E-Mail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Newsletter",
              "displayName": "Newsletter",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "How did you become attentive on the pCon.planner",
              "displayName": "How did you become attentive on the pCon.planner",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "I use the pCon.planner as",
              "displayName": "I use the pCon.planner as",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Version",
              "displayName": "Version",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Edition",
              "displayName": "Edition",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "CompanyPhone",
              "displayName": "CompanyPhone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        4740,
        5860
      ],
      "id": "4b673b2f-b654-4b04-a777-9502fc612f04",
      "name": "Google Sheets19",
      "executeOnce": true,
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Pld7csTWl31TEr2y",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('HTTP Request8').first().json?.data || $('HTTP Request8').first().json?.error?.message || $('HTTP Request7').first().json?.data || $('HTTP Request7').first().json?.error?.message || \"nichts gefunden\" }}\n",
        "options": {
          "systemMessage": "=Suche hier die telefonnummer raus und Gib nur die Telefonnummer zurück mit zwei einzigen kurzen worten das beschreibt wo du sie gefunden hast und zu wem sie gehört. Wenn du dazu keine Information hast schreibe \"allgemein\". Keine weiteren Informationen. z.B.\nAnna Schuhmann: +49 44040033003\nallgemein: 40400404\n\nwenn du keine passende Telefonnummer findest gebe nur none zurrück und sonst nichts "
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        3780,
        5880
      ],
      "id": "24590ff2-75e1-45c8-a1c0-05d9b6ec6015",
      "name": "AI Agent10",
      "alwaysOutputData": false,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "df41ef12-68ad-48d2-9ab4-6a7423818213",
              "leftValue": "={{ $json.output }}",
              "rightValue": "none",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        4260,
        5880
      ],
      "id": "4b463f9a-a2a4-4bec-9fa1-978fb07e453c",
      "name": "If10"
    },
    {
      "parameters": {
        "url": "={{ $('Loop Over Items3').first().json['E-Mail'] ? \"http://www.\" + $('Loop Over Items3').first().json['E-Mail'].split(\"@\")[1] : '' }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        3040,
        5880
      ],
      "id": "be6406f4-5bd1-46fd-aee2-4bede365ef90",
      "name": "HTTP Request7",
      "alwaysOutputData": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "url": "={{ $('Loop Over Items3').first().json['E-Mail'] ? \"http://www.\" + $('Loop Over Items3').first().json['E-Mail'].split(\"@\")[1] + \"/impressum\" : '' }}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        3360,
        5880
      ],
      "id": "3c76f909-c85b-4f7b-813a-879bce37a077",
      "name": "HTTP Request8",
      "alwaysOutputData": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "Replace Me5",
      "typeVersion": 1,
      "position": [
        5100,
        440
      ],
      "id": "3de05852-939d-4685-8336-88251bdf0d3a"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI",
          "mode": "list",
          "cachedResultName": "K&S-Automation-Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 211066673,
          "mode": "list",
          "cachedResultName": "Tabellenblatt1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit#gid=211066673"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        400,
        440
      ],
      "id": "c4acc506-a784-4e92-a9fa-396ee0a96211",
      "name": "Google Sheets22",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Pld7csTWl31TEr2y",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "6c478565-ae01-4b2d-878f-b2f53ce7d86a",
              "leftValue": "={{ $('Loop Over Items5').first().json.Company.toString()}}",
              "rightValue": "\"allgemein: allgemein\"",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1600,
        440
      ],
      "id": "44012fc0-b892-42bb-a88f-b9d3bde50c12",
      "name": "isEmailPrivat3"
    },
    {
      "parameters": {
        "options": {
          "reset": false
        }
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        680,
        440
      ],
      "id": "5578b2f3-66f3-4d3c-9e92-eeaa4a6ee26e",
      "name": "Loop Over Items5"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4o-mini",
          "mode": "list",
          "cachedResultName": "gpt-4o-mini"
        },
        "options": {
          "temperature": 0
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        2040,
        700
      ],
      "id": "5d2b6850-bf9c-4b33-be3b-bf046df4df2a",
      "name": "OpenAI Chat Model4",
      "credentials": {
        "openAiApi": {
          "id": "F4TTzvzjjYGqOAGL",
          "name": "KS-Media"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI",
          "mode": "list",
          "cachedResultName": "K&S-Automation-Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1135880709,
          "mode": "list",
          "cachedResultName": "RowsToDelete",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit#gid=1135880709"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Date": "={{ $('Loop Over Items5').item.json.Date }}",
            "Time": "={{ $('Loop Over Items5').item.json.Time }}",
            "User-IP": "={{ $('Loop Over Items5').item.json['User-IP'] }}",
            "Form-Language": "={{ $('Loop Over Items5').item.json['Form-Language'] }}",
            "Salutation": "={{ $('Loop Over Items5').item.json.Salutation }}",
            "First name": "={{ $('Loop Over Items5').item.json['First name'] }}",
            "Name": "={{ $('Loop Over Items5').item.json.Name }}",
            "Company": "={{ $('Loop Over Items5').item.json.Company }}",
            "Address": "={{ $('Loop Over Items5').item.json.Address }}",
            "Country": "={{ $('Loop Over Items5').item.json.Country }}",
            "E-Mail": "={{ $('Loop Over Items5').item.json['E-Mail'] }}",
            "Newsletter": "={{ $('Loop Over Items5').item.json.Newsletter }}",
            "How did you become attentive on the pCon.planner": "={{ $('Loop Over Items5').item.json['How did you become attentive on the pCon.planner'] }}",
            "I use the pCon.planner as": "={{ $('Loop Over Items5').item.json['I use the pCon.planner as'] }}",
            "Version": "={{ $('Loop Over Items5').item.json.Version }}",
            "Edition": "={{ $('Loop Over Items5').item.json.Edition }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "Date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Time",
              "displayName": "Time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "User-IP",
              "displayName": "User-IP",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Form-Language",
              "displayName": "Form-Language",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Salutation",
              "displayName": "Salutation",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "First name",
              "displayName": "First name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Company",
              "displayName": "Company",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Address",
              "displayName": "Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Country",
              "displayName": "Country",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "E-Mail",
              "displayName": "E-Mail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Newsletter",
              "displayName": "Newsletter",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "How did you become attentive on the pCon.planner",
              "displayName": "How did you become attentive on the pCon.planner",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "I use the pCon.planner as",
              "displayName": "I use the pCon.planner as",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Version",
              "displayName": "Version",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Edition",
              "displayName": "Edition",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "branche",
              "displayName": "branche",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        3460,
        -140
      ],
      "id": "56d6000b-9917-43c8-a16d-980ceabb1047",
      "name": "Google Sheets23",
      "executeOnce": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Pld7csTWl31TEr2y",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Loop Over Items5').first().json['E-Mail'].split('@')[1].split('.')[0] }}",
        "options": {
          "systemMessage": "=You are a system that checks if an input string matches any of the following 303 company names, accounting for minor spelling errors, case insensitivity, partial matches, or variations (e.g., \"THONET GmbH\" should match \"THONET\", but \"Büro GmbH\" should not match \"ASSMANN BÜROMÖBEL\"). Use fuzzy matching or a similar technique to handle variations, but ensure generic terms like \"Büro GmbH\" do not incorrectly match specific company names. Return **1** if the input matches any company name, and **0** if it does not. Do not return any other output.\n\nList of company names:\n[\n \n    \"COR\", \"DHDG - Trendoffice\", \"Ondarreta\", \"Vonk\", \"DHDG - Züco\", \"B&T Design\", \"Narbutas International\", \"Loda Mobilya\", \"Preform\", \"ZGONIC\",\n    \"Groupe Roset\", \"Prostoria\", \"Acial\", \"SCHRAMM\", \"Kotzolt International\", \"conmoto\", \"myO\", \"DHDG - Bosse\", \"Van Esch\", \"Studiotools\", \"Noti\",\n    \"Lammhults\", \"BRUNE Sitzmöbel\", \"Mikomax (Hushoffice)\", \"Ahrend\", \"Kindermann\", \"Moll System- und Funktionsmöbel\", \"Bartscher\", \"Sesta\", \"C + P Möbelsysteme\",\n    \"Allermuir\", \"Ocee & Four Design\", \"FORMOEBEL\", \"Holmris B8\", \"Sono Group\", \"Franz Blaha Sitz- und Büromöbel\", \"Akustik Office Systeme\", \"GLIMAKRA of SWEDEN\",\n    \"Vitrine Masters\", \"FREIFRAU MANUFAKTUR\", \"Hüba\", \"Diemme\", \"Dileoffice\", \"WiBU ObjektPlus\", \"middel Büroeinrichtungen\", \"Dietiker\", \"Blabla-Cube\",\n    \"OFFICEPRO SEATING\", \"westermann products\", \"Kinnarps\", \"Plydesign\", \"Fellowes\", \"Martinelli Luce\", \"Casala\", \"BOX17\", \"ACTIU\", \"L&C stendal\",\n    \"Deberenn\", \"EMOBOK\", \"haworth\", \"Klain Büromöbel GmbH\", \"AndTradition\", \"Quinti\", \"Savo Office Seating\", \"W. Schillig objects\", \"Schulte Lagertechnik\",\n    \"Nurus\", \"VASTARREDO\", \"CS Rugs\", \"Aeris\", \"silent.office.wall\", \"Schaffenburg Office Furniture\", \"CEKA\", \"String Furniture\", \"Vitra\", \"OFFECCT\",\n    \"EMU\", \"DRAENERT\", \"COLUMBIA\", \"Robberechts\", \"Et al.\", \"ROCKWOOL Rockfon\", \"SCHNEEWEISS interior Hiller Braun rosconi\", \"BINBIN\", \"Zumtobel Lighting\",\n    \"STEELBOX\", \"Ofitres\", \"SUNSET CREATION\", \"Acustio\", \"Alea\", \"FRANDSEN\", \"Création Baumann\", \"Tanaman\", \"ECHOJAZZ\", \"BakkerElkhuizen\",\n    \"Regent Beleuchtungskörper\", \"AB Edsbyverken\", \"STALGAST\", \"orangebox\", \"Lightnet\", \"Antrax\", \"EFKA\", \"YAASA\", \"EFG European Furniture Group\",\n    \"IKONO\", \"Herman Miller\", \"Möbelwerke Prenzlau\", \"Normann Copenhagen\", \"Ege Carpets\", \"Archiutti\", \"Hammerbacher\", \"PROFIm\", \"Inclass\", \"Egoé life\",\n    \"Alias\", \"Westaro\", \"Knoll International\", \"ANKER\", \"Fritz Hansen\", \"Sitia\", \"WeibelWeibel\", \"Texdecor\", \"JENSENplus\", \"PJ Production\", \"Cappellini\",\n    \"Arper\", \"A. & H. MEYER\", \"WERKSITZ\", \"Viccarbe\", \"LE KLINT\", \"Labofa\", \"Senator\", \"BHM\", \"CUF Milano by Centrufficio\", \"Reyem\", \"Bene\", \"Phone Alone\",\n    \"OFFICEBRICKS\", \"Swan products\", \"WINI-Büromöbel\", \"Treston\", \"KLEINKOPF Objektmöbel\", \"ALBA CR\", \"Bejot\", \"Leyform\", \"Erich Keller\", \"Audo Copenhagen\",\n    \"Sancal\", \"Bedrunka+Hirth\", \"Dieffebi\", \"ICF\", \"BALMA\", \"Nordgröna\", \"Abstracta\", \"SITWELL STEIFENSAND\", \"DVO\", \"Cassina\", \"kühnle'waiko\", \"PLYCOLLECTION\",\n    \"Sellex\", \"Functionals\", \"Feltouch\", \"Framery Oy\", \"SITLOSOPHY-DIVISIONE ITALIA ELLECI OFFICE\", \"Schnieder sitzt!\", \"SMV Sitz- & Objektmöbel\", \"Möbelfabrik Horgenglarus\",\n    \"TRILUX\", \"Soennecken\", \"ROVO CHAIR Völkle Bürostühle\", \"Martex\", \"CLEN\", \"Wilkhahn\", \"THONET\", \"jhs Interaktiv\", \"Mobimex\", \"Dataflex\", \"Horreds\",\n    \"Brunner (DE)\", \"Limes Raumakustik\", \"Zemp\", \"Union\", \"YOMEI\", \"Bisley\", \"Procedes i-d interior design\", \"Polyvision\", \"AGORAphil\", \"Dilinski Objekteinrichtungen\",\n    \"Richard Lampert\", \"SILEOPTA\", \"FlowerArt - styleGREEN\", \"Mebelux\", \"Brunner (FR)\", \"PAVOY GmbH Paul van Oyen\", \"OBJECT CARPET Objekt-Teppichboden\", \"UMAGE\",\n    \"Otto Kind\", \"La PODS Company\", \"Mobimétal\", \"Nowy Styl\", \"Sokoa\", \"art aqua\", \"VARIO BüroEinrichtungen\", \"Negra\", \"VERPAN\", \"Brunner (NL)\", \"Geramöbel\",\n    \"Actiforce\", \"Kleiber\", \"ASA Plastici\", \"TOBIAS GRAU\", \"Schallsauger - Kasper\", \"Dynamobel\", \"PicnixX\", \"MIZETTO\", \"galneoscreen – wende interaktiv\", \"Visplay\",\n    \"MARELLI\", \"miinu\", \"De Sede\", \"bordbar design\", \"Mara\", \"ROPIMEX\", \"HAIDER BIOSWING\", \"CHAT BOARD\", \"Rossoacoustic-Nimbus Group\", \"F.-Martin Steifensand Büromöbel\",\n    \"ASSMANN BÜROMÖBEL\", \"EOL GROUP (IRL)\", \"DOBERGO\", \"WÜNSCHE\", \"FUGA Mobilya\", \"Acloud®\", \"RIM\", \"Scab\", \"366 CONCEPT\", \"Louis Poulsen Lighting\", \"ONGO\",\n    \"Conceptual Furniture Design\", \"lento\", \"HAY\", \"Alki\", \"Belux\", \"Ismobel\", \"Seledue\", \"Piaval\", \"Brunner (GB)\", \"Lapalma\", \"Mayer Manufaktur\", \"EUGEN WOLF\",\n    \"Gautier\", \"Artek\", \"Muuto\", \"Flexfurn\", \"About Office\", \"Quadrifoglio\", \"Schulte Elektrotechnik - EVOline\", \"GAPSA\", \"Interstuhl Büromöbel\", \"Karl Kilpper\",\n    \"Milani\", \"B.PRO\", \"Midgard Licht\", \"Girsberger\", \"Gerriets\", \"Flexxica\", \"WDESIGN by Wilk\", \"VANK\", \"Pedestal\", \"Modis Interiors\", \"e15\", \"objectiv\",\n    \"Sedus Büromöbel / Office Furniture\", \"REISS Büromöbel\", \"Klimakustik by Beiermeister\", \"Impact Acoustic\", \"Polmarco\", \"True Design\", \"TIPTOE\", \"Schultz\",\n    \"INTUIT by Softrend\", \"Mias OC\", \"LD SEATING\", \"Silen\", \"CEHA\", \"Löffler\", \"Montana Furniture\", \"Filex by Fellowes\", \"May Design\", \"ZEITRAUM\", \"Chairworkx\",\n    \"FLOKK\", \"GGI\", \"Boss Design\", \"Sara\", \"Kesta-Somomar\", \"ISKU\", \"EOL GROUP\", \"ACCO Brands\", \"Extremis\", \"KÖHL\", \"HOWE\", \"ERGO-line by Kern Studer\",\n    \"Motiv Home\", \"NEW TENDENCY\", \"Martela\", \"bimos\", \"REXITE\", \"Mobellinea\", \"Blomus\", \"Hund Office GmbH\", \"HUSSL Sitzmöbel\", \"bndr.company\", \"Andersen Furniture\",\n    \"Vorwerk - Hamelner Teppichwerke\", \"Scan Sørlie\", \"Febrü Büromöbel\", \"Berlin Acoustics\", \"Molto Luce\", \"Kleusberg\", \"Forma 5\", \"Dusyma Kindergartenbedarf\",\n    \"Glamox GmbH\", \"Walter Knoll\", \"FROST\", \"Julius vom Hofe\", \"Loook Industries\", \"NYINK\", \"NORR11\", \"AKABA\", \"Schönbuch\", \"DutchGlobe\", \"Made Design\",\n    \"Müller Möbelwerkstätten\", \"Think Paper\", \"FAMO\", \"XAL\", \"HOUE\", \"Akupanel\", \"System 180\", \"MOVING\", \"Arcchio\", \"MDF Italia | Acerbis\", \"Thorn Lighting\",\n    \"SITLOSOPHY-EXPORT DIVISION ARTE & D\", \"Herbert Waldmann\", \"Mater\", \".mdd\", \"RODET\", \"KAMO\", \"Bial Meble\", \"Echo Büromöbel\", \"Mute Sp. z o.o.\", \"Sitek\",\n    \"EasternGraphics - Materials\", \"INNO INTERIOR\", \"Renz\", \"FLEISCHER Büromöbelwerk\", \"GRID System\", \"Rocholz\", \"VINCO – Groupe Pierre HENRY\", \"WEISHÄUPL Möbelwerkstätten\",\n    \"NEWFORM UFFICIO by Aran World\", \"Festo\", \"Harmony\", \"Ergopanel\", \"Stua\", \"Vilagrasa\", \"Viasit Bürositzmöbel\", \"Taiga Concept\", \"MARO Office Furniture\",\n    \"MANADE\", \"Zurbuchen AG Amlikon\", \"Vepa\", \"EinrichtWerk\", \"HUMANSCALE International Holding IDA\", \"SMART Technologies\", \"roomours Kommunikationstools\",\n    \"TTS Transport - und Trennwand - Systeme\", \"SPÄH designed acoustic\", \"hali gmbh\", \"Premium\", \"Bigla Office\", \"META-Regalbau\", \"Midj\", \"Lintex\", \"Mobboli\",\n    \"IDEAL Krug & Priester\", \"Askia Furniture\", \"ophelis\", \"BURONOMIC\", \"Goodtone\", \"FANTONI\", \"Pami\", \"DHDG - Dauphin\", \"Mex Büromöbel\", \"Legamaster\",\n    \"Palmberg Büroeinrichtungen + Service\", \"Colebrook Bosson Saunders\", \"Mobil M\", \"Adapt\", \"Klöber\", \"Giroflex (Suisse)\", \"INFINITI\", \"FREZZA\", \"WUTEH\",\n    \"IB Connect\", \"OKA - Büromöbel\", \"LAS MOBILI\", \"Treku\", \"Mobitec\", \"planmöbel.\", \"ClassiCon\", \"Artemide\", \"Vaghi\", \"WAGNER - By Topstar\", \"BOLN\", \"Resol\",\n    \"Gumpo\", \"Embru Werke (CH)\", \"Neudoerfler Office Systems\", \"magnetoplan\", \"Bralco\", \"Punt\", \"Kristalia\", \"Marset\", \"Neomounts\", \"BOSIG\", \"Embru Werke\",\n    \"Koleksiyon\", \"DESKIN\", \"Delaoliva\", \"Mauser Einrichtungssysteme\", \"NORTHERN\", \"Johanson design\", \"Caimi Brevetti\", \"Suono Acoustics\", \"Cue Solutions\",\n    \"Occony\", \"Aarsland\", \"Legrand\", \"Fameg\", \"Kastel\", \"Lista Office LO\", \"FLUFFO\", \"Theo Kerkmann Büromöbelfabrik\", \"Connection\", \"WEYEL mediasolutions\",\n    \"VENTA by Büchin Design\", \"Brunner (CH)\", \"Walter K.\", \"Chameleon by SmitVisual\", \"Occhio\", \"Leolux LX\", \"Steelcase\", \"Sigel\", \"+Halle\", \"Zilenzio\",\n    \"DeBlick\", \"Trebord\", \"Antares\", \"IBEBI\", \"Bogaerts Furniture & Lighting\", \"Ecophon Saint-Gobain\", \"Ergotron\", \"Götessons Design Group\", \"Voortman Kantoormeubelen\",\n    \"Andreu World\", \"Pablo Designs\", \"PENDING\", \"Jakob Maul\", \"Cascando Products\", \"JGGroup\", \"Concession Europe\", \"Röthlisberger Kollektion\", \"JONAS IHREBORN\",\n    \"Wacosystems\", \"UNILUX & KOS Lighting\", \"Piure\", \"Gaber\", \"Wiesner-Hager Möbel\", \"LISTA\", \"Cube Design\", \"Novus Dahle\", \"Adeco\", \"Zens Electronics\",\n    \"ST-Systemtronic\", \"Wästberg Lighting\", \"MAGIS\", \"Slalom\", \"Artifort\", \"SilentLab\", \"Stukenbröker + Rollmann\", \"Kusch+Co\", \"Genexco\", \"DURABLE Hunke & Jochheim\",\n    \"ECOcero\", \"ALBRECHT JUNG\", \"Svenheim Office\", \"Entrance\", \"Variand Furniture\", \"Fermob & Vlaemynck\", \"LEUWICO\", \"Bulo\", \"König + Neurath\", \"TEMPO BY DIGITEX\",\n    \"Bürotime\", \"Limobel\", \"accodo Projekt\", \"werner works\", \"Ergodata\", \"K&S Grossküchenbibliothek\", \"Sitland\", \"Guialmi\", \"Scholl Apparatebau\", \"Moravia\",\n    \"Marbet\", \"Bachmann\", \"Thur Metall\", \"Eurosit\", \"Studiobricks Acoustic Booths\", \"ARTECK DESIGN\", \"Arrow Group\", \"fm Büromöbel Franz Meyer\", \"ERIDES\",\n    \"Cegim\", \"Expormim\", \"Sitag\", \"FURNITURE FOR GOOD\", \"BuzziSpace\", \"Ragnars\", \"Fumac\", \"EOL GROUP (UK)\", \"Spiegels\", \"Fröscher\", \"Mauser Sitzkultur\",\n    \"Markant Office Furniture\", \"2WorkFromX\", \"Gottardo LED\"\n]\n\n\nInstructions:\n1. Compare the input string to the list of company names using a fuzzy matching algorithm or similar technique (e.g., Levenshtein distance, partial string matching).\n2. Consider the following for matching:\n   - Ignore case (e.g., \"thonet\" matches \"THONET\").\n   - Allow minor spelling errors (e.g., \"THOENT\" matches \"THONET\").\n   - Allow additional words like \"GmbH\", \"AG\", \"Ltd\", etc. (e.g., \"THONET GmbH\" matches \"THONET\").\n   - Allow partial matches for the core company name (e.g., \"Zumtobel\" matches \"Zumtobel Lighting\").\n   - Exclude generic terms like \"Büro GmbH\", \"Office GmbH\", or \"Möbel AG\" unless they are part of a specific company name (e.g., \"Büro GmbH\" should not match \"ASSMANN BÜROMÖBEL\").\n3. Return **1** if the input matches any company name in the list based on the above criteria.\n4. Return **0** if the input does not match any company name.\n5. Do not return any other output, explanation, or text."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        2420,
        -160
      ],
      "id": "d26e3b69-c7be-401e-a61d-d88e06f09d21",
      "name": "AI Agent13",
      "alwaysOutputData": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "df41ef12-68ad-48d2-9ab4-6a7423818213",
              "leftValue": "={{ $('AI Agent13').first().json.output }}",
              "rightValue": "1",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2940,
        -100
      ],
      "id": "e9589c89-9a8e-467b-96bf-262cff6f0042",
      "name": "If13"
    },
    {
      "parameters": {
        "content": "# Is Already partner advanced",
        "height": 1580,
        "width": 6720
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -60,
        -520
      ],
      "typeVersion": 1,
      "id": "7d86c060-cc06-4fa7-9677-df189db288f4",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Loop Over Items5').first().json.Company }}",
        "options": {
          "systemMessage": "You are a system that checks if an input string matches any of the following 303 company names, accounting for minor spelling errors, case insensitivity, partial matches, or variations (e.g., \"THONET GmbH\" should match \"THONET\", but \"Büro GmbH\" should not match \"ASSMANN BÜROMÖBEL\"). Use fuzzy matching or a similar technique to handle variations, but ensure generic terms like \"Büro GmbH\" do not incorrectly match specific company names. Return **1** if the input matches any company name, and **0** if it does not. Do not return any other output.\n\nList of company names:\n[\n \n    \"COR\", \"DHDG - Trendoffice\", \"Ondarreta\", \"Vonk\", \"DHDG - Züco\", \"B&T Design\", \"Narbutas International\", \"Loda Mobilya\", \"Preform\", \"ZGONIC\",\n    \"Groupe Roset\", \"Prostoria\", \"Acial\", \"SCHRAMM\", \"Kotzolt International\", \"conmoto\", \"myO\", \"DHDG - Bosse\", \"Van Esch\", \"Studiotools\", \"Noti\",\n    \"Lammhults\", \"BRUNE Sitzmöbel\", \"Mikomax (Hushoffice)\", \"Ahrend\", \"Kindermann\", \"Moll System- und Funktionsmöbel\", \"Bartscher\", \"Sesta\", \"C + P Möbelsysteme\",\n    \"Allermuir\", \"Ocee & Four Design\", \"FORMOEBEL\", \"Holmris B8\", \"Sono Group\", \"Franz Blaha Sitz- und Büromöbel\", \"Akustik Office Systeme\", \"GLIMAKRA of SWEDEN\",\n    \"Vitrine Masters\", \"FREIFRAU MANUFAKTUR\", \"Hüba\", \"Diemme\", \"Dileoffice\", \"WiBU ObjektPlus\", \"middel Büroeinrichtungen\", \"Dietiker\", \"Blabla-Cube\",\n    \"OFFICEPRO SEATING\", \"westermann products\", \"Kinnarps\", \"Plydesign\", \"Fellowes\", \"Martinelli Luce\", \"Casala\", \"BOX17\", \"ACTIU\", \"L&C stendal\",\n    \"Deberenn\", \"EMOBOK\", \"haworth\", \"Klain Büromöbel GmbH\", \"AndTradition\", \"Quinti\", \"Savo Office Seating\", \"W. Schillig objects\", \"Schulte Lagertechnik\",\n    \"Nurus\", \"VASTARREDO\", \"CS Rugs\", \"Aeris\", \"silent.office.wall\", \"Schaffenburg Office Furniture\", \"CEKA\", \"String Furniture\", \"Vitra\", \"OFFECCT\",\n    \"EMU\", \"DRAENERT\", \"COLUMBIA\", \"Robberechts\", \"Et al.\", \"ROCKWOOL Rockfon\", \"SCHNEEWEISS interior Hiller Braun rosconi\", \"BINBIN\", \"Zumtobel Lighting\",\n    \"STEELBOX\", \"Ofitres\", \"SUNSET CREATION\", \"Acustio\", \"Alea\", \"FRANDSEN\", \"Création Baumann\", \"Tanaman\", \"ECHOJAZZ\", \"BakkerElkhuizen\",\n    \"Regent Beleuchtungskörper\", \"AB Edsbyverken\", \"STALGAST\", \"orangebox\", \"Lightnet\", \"Antrax\", \"EFKA\", \"YAASA\", \"EFG European Furniture Group\",\n    \"IKONO\", \"Herman Miller\", \"Möbelwerke Prenzlau\", \"Normann Copenhagen\", \"Ege Carpets\", \"Archiutti\", \"Hammerbacher\", \"PROFIm\", \"Inclass\", \"Egoé life\",\n    \"Alias\", \"Westaro\", \"Knoll International\", \"ANKER\", \"Fritz Hansen\", \"Sitia\", \"WeibelWeibel\", \"Texdecor\", \"JENSENplus\", \"PJ Production\", \"Cappellini\",\n    \"Arper\", \"A. & H. MEYER\", \"WERKSITZ\", \"Viccarbe\", \"LE KLINT\", \"Labofa\", \"Senator\", \"BHM\", \"CUF Milano by Centrufficio\", \"Reyem\", \"Bene\", \"Phone Alone\",\n    \"OFFICEBRICKS\", \"Swan products\", \"WINI-Büromöbel\", \"Treston\", \"KLEINKOPF Objektmöbel\", \"ALBA CR\", \"Bejot\", \"Leyform\", \"Erich Keller\", \"Audo Copenhagen\",\n    \"Sancal\", \"Bedrunka+Hirth\", \"Dieffebi\", \"ICF\", \"BALMA\", \"Nordgröna\", \"Abstracta\", \"SITWELL STEIFENSAND\", \"DVO\", \"Cassina\", \"kühnle'waiko\", \"PLYCOLLECTION\",\n    \"Sellex\", \"Functionals\", \"Feltouch\", \"Framery Oy\", \"SITLOSOPHY-DIVISIONE ITALIA ELLECI OFFICE\", \"Schnieder sitzt!\", \"SMV Sitz- & Objektmöbel\", \"Möbelfabrik Horgenglarus\",\n    \"TRILUX\", \"Soennecken\", \"ROVO CHAIR Völkle Bürostühle\", \"Martex\", \"CLEN\", \"Wilkhahn\", \"THONET\", \"jhs Interaktiv\", \"Mobimex\", \"Dataflex\", \"Horreds\",\n    \"Brunner (DE)\", \"Limes Raumakustik\", \"Zemp\", \"Union\", \"YOMEI\", \"Bisley\", \"Procedes i-d interior design\", \"Polyvision\", \"AGORAphil\", \"Dilinski Objekteinrichtungen\",\n    \"Richard Lampert\", \"SILEOPTA\", \"FlowerArt - styleGREEN\", \"Mebelux\", \"Brunner (FR)\", \"PAVOY GmbH Paul van Oyen\", \"OBJECT CARPET Objekt-Teppichboden\", \"UMAGE\",\n    \"Otto Kind\", \"La PODS Company\", \"Mobimétal\", \"Nowy Styl\", \"Sokoa\", \"art aqua\", \"VARIO BüroEinrichtungen\", \"Negra\", \"VERPAN\", \"Brunner (NL)\", \"Geramöbel\",\n    \"Actiforce\", \"Kleiber\", \"ASA Plastici\", \"TOBIAS GRAU\", \"Schallsauger - Kasper\", \"Dynamobel\", \"PicnixX\", \"MIZETTO\", \"galneoscreen – wende interaktiv\", \"Visplay\",\n    \"MARELLI\", \"miinu\", \"De Sede\", \"bordbar design\", \"Mara\", \"ROPIMEX\", \"HAIDER BIOSWING\", \"CHAT BOARD\", \"Rossoacoustic-Nimbus Group\", \"F.-Martin Steifensand Büromöbel\",\n    \"ASSMANN BÜROMÖBEL\", \"EOL GROUP (IRL)\", \"DOBERGO\", \"WÜNSCHE\", \"FUGA Mobilya\", \"Acloud®\", \"RIM\", \"Scab\", \"366 CONCEPT\", \"Louis Poulsen Lighting\", \"ONGO\",\n    \"Conceptual Furniture Design\", \"lento\", \"HAY\", \"Alki\", \"Belux\", \"Ismobel\", \"Seledue\", \"Piaval\", \"Brunner (GB)\", \"Lapalma\", \"Mayer Manufaktur\", \"EUGEN WOLF\",\n    \"Gautier\", \"Artek\", \"Muuto\", \"Flexfurn\", \"About Office\", \"Quadrifoglio\", \"Schulte Elektrotechnik - EVOline\", \"GAPSA\", \"Interstuhl Büromöbel\", \"Karl Kilpper\",\n    \"Milani\", \"B.PRO\", \"Midgard Licht\", \"Girsberger\", \"Gerriets\", \"Flexxica\", \"WDESIGN by Wilk\", \"VANK\", \"Pedestal\", \"Modis Interiors\", \"e15\", \"objectiv\",\n    \"Sedus Büromöbel / Office Furniture\", \"REISS Büromöbel\", \"Klimakustik by Beiermeister\", \"Impact Acoustic\", \"Polmarco\", \"True Design\", \"TIPTOE\", \"Schultz\",\n    \"INTUIT by Softrend\", \"Mias OC\", \"LD SEATING\", \"Silen\", \"CEHA\", \"Löffler\", \"Montana Furniture\", \"Filex by Fellowes\", \"May Design\", \"ZEITRAUM\", \"Chairworkx\",\n    \"FLOKK\", \"GGI\", \"Boss Design\", \"Sara\", \"Kesta-Somomar\", \"ISKU\", \"EOL GROUP\", \"ACCO Brands\", \"Extremis\", \"KÖHL\", \"HOWE\", \"ERGO-line by Kern Studer\",\n    \"Motiv Home\", \"NEW TENDENCY\", \"Martela\", \"bimos\", \"REXITE\", \"Mobellinea\", \"Blomus\", \"Hund Office GmbH\", \"HUSSL Sitzmöbel\", \"bndr.company\", \"Andersen Furniture\",\n    \"Vorwerk - Hamelner Teppichwerke\", \"Scan Sørlie\", \"Febrü Büromöbel\", \"Berlin Acoustics\", \"Molto Luce\", \"Kleusberg\", \"Forma 5\", \"Dusyma Kindergartenbedarf\",\n    \"Glamox GmbH\", \"Walter Knoll\", \"FROST\", \"Julius vom Hofe\", \"Loook Industries\", \"NYINK\", \"NORR11\", \"AKABA\", \"Schönbuch\", \"DutchGlobe\", \"Made Design\",\n    \"Müller Möbelwerkstätten\", \"Think Paper\", \"FAMO\", \"XAL\", \"HOUE\", \"Akupanel\", \"System 180\", \"MOVING\", \"Arcchio\", \"MDF Italia | Acerbis\", \"Thorn Lighting\",\n    \"SITLOSOPHY-EXPORT DIVISION ARTE & D\", \"Herbert Waldmann\", \"Mater\", \".mdd\", \"RODET\", \"KAMO\", \"Bial Meble\", \"Echo Büromöbel\", \"Mute Sp. z o.o.\", \"Sitek\",\n    \"EasternGraphics - Materials\", \"INNO INTERIOR\", \"Renz\", \"FLEISCHER Büromöbelwerk\", \"GRID System\", \"Rocholz\", \"VINCO – Groupe Pierre HENRY\", \"WEISHÄUPL Möbelwerkstätten\",\n    \"NEWFORM UFFICIO by Aran World\", \"Festo\", \"Harmony\", \"Ergopanel\", \"Stua\", \"Vilagrasa\", \"Viasit Bürositzmöbel\", \"Taiga Concept\", \"MARO Office Furniture\",\n    \"MANADE\", \"Zurbuchen AG Amlikon\", \"Vepa\", \"EinrichtWerk\", \"HUMANSCALE International Holding IDA\", \"SMART Technologies\", \"roomours Kommunikationstools\",\n    \"TTS Transport - und Trennwand - Systeme\", \"SPÄH designed acoustic\", \"hali gmbh\", \"Premium\", \"Bigla Office\", \"META-Regalbau\", \"Midj\", \"Lintex\", \"Mobboli\",\n    \"IDEAL Krug & Priester\", \"Askia Furniture\", \"ophelis\", \"BURONOMIC\", \"Goodtone\", \"FANTONI\", \"Pami\", \"DHDG - Dauphin\", \"Mex Büromöbel\", \"Legamaster\",\n    \"Palmberg Büroeinrichtungen + Service\", \"Colebrook Bosson Saunders\", \"Mobil M\", \"Adapt\", \"Klöber\", \"Giroflex (Suisse)\", \"INFINITI\", \"FREZZA\", \"WUTEH\",\n    \"IB Connect\", \"OKA - Büromöbel\", \"LAS MOBILI\", \"Treku\", \"Mobitec\", \"planmöbel.\", \"ClassiCon\", \"Artemide\", \"Vaghi\", \"WAGNER - By Topstar\", \"BOLN\", \"Resol\",\n    \"Gumpo\", \"Embru Werke (CH)\", \"Neudoerfler Office Systems\", \"magnetoplan\", \"Bralco\", \"Punt\", \"Kristalia\", \"Marset\", \"Neomounts\", \"BOSIG\", \"Embru Werke\",\n    \"Koleksiyon\", \"DESKIN\", \"Delaoliva\", \"Mauser Einrichtungssysteme\", \"NORTHERN\", \"Johanson design\", \"Caimi Brevetti\", \"Suono Acoustics\", \"Cue Solutions\",\n    \"Occony\", \"Aarsland\", \"Legrand\", \"Fameg\", \"Kastel\", \"Lista Office LO\", \"FLUFFO\", \"Theo Kerkmann Büromöbelfabrik\", \"Connection\", \"WEYEL mediasolutions\",\n    \"VENTA by Büchin Design\", \"Brunner (CH)\", \"Walter K.\", \"Chameleon by SmitVisual\", \"Occhio\", \"Leolux LX\", \"Steelcase\", \"Sigel\", \"+Halle\", \"Zilenzio\",\n    \"DeBlick\", \"Trebord\", \"Antares\", \"IBEBI\", \"Bogaerts Furniture & Lighting\", \"Ecophon Saint-Gobain\", \"Ergotron\", \"Götessons Design Group\", \"Voortman Kantoormeubelen\",\n    \"Andreu World\", \"Pablo Designs\", \"PENDING\", \"Jakob Maul\", \"Cascando Products\", \"JGGroup\", \"Concession Europe\", \"Röthlisberger Kollektion\", \"JONAS IHREBORN\",\n    \"Wacosystems\", \"UNILUX & KOS Lighting\", \"Piure\", \"Gaber\", \"Wiesner-Hager Möbel\", \"LISTA\", \"Cube Design\", \"Novus Dahle\", \"Adeco\", \"Zens Electronics\",\n    \"ST-Systemtronic\", \"Wästberg Lighting\", \"MAGIS\", \"Slalom\", \"Artifort\", \"SilentLab\", \"Stukenbröker + Rollmann\", \"Kusch+Co\", \"Genexco\", \"DURABLE Hunke & Jochheim\",\n    \"ECOcero\", \"ALBRECHT JUNG\", \"Svenheim Office\", \"Entrance\", \"Variand Furniture\", \"Fermob & Vlaemynck\", \"LEUWICO\", \"Bulo\", \"König + Neurath\", \"TEMPO BY DIGITEX\",\n    \"Bürotime\", \"Limobel\", \"accodo Projekt\", \"werner works\", \"Ergodata\", \"K&S Grossküchenbibliothek\", \"Sitland\", \"Guialmi\", \"Scholl Apparatebau\", \"Moravia\",\n    \"Marbet\", \"Bachmann\", \"Thur Metall\", \"Eurosit\", \"Studiobricks Acoustic Booths\", \"ARTECK DESIGN\", \"Arrow Group\", \"fm Büromöbel Franz Meyer\", \"ERIDES\",\n    \"Cegim\", \"Expormim\", \"Sitag\", \"FURNITURE FOR GOOD\", \"BuzziSpace\", \"Ragnars\", \"Fumac\", \"EOL GROUP (UK)\", \"Spiegels\", \"Fröscher\", \"Mauser Sitzkultur\",\n    \"Markant Office Furniture\", \"2WorkFromX\", \"Gottardo LED\"\n]\n\nInstructions:\n1. Compare the input string to the list of company names using a fuzzy matching algorithm or similar technique (e.g., Levenshtein distance, partial string matching).\n2. Consider the following for matching:\n   - Ignore case (e.g., \"thonet\" matches \"THONET\").\n   - Allow minor spelling errors (e.g., \"THOENT\" matches \"THONET\").\n   - Allow additional words like \"GmbH\", \"AG\", \"Ltd\", etc. (e.g., \"THONET GmbH\" matches \"THONET\").\n   - Allow partial matches for the core company name (e.g., \"Zumtobel\" matches \"Zumtobel Lighting\").\n   - Exclude generic terms like \"Büro GmbH\", \"Office GmbH\", or \"Möbel AG\" unless they are part of a specific company name (e.g., \"Büro GmbH\" should not match \"ASSMANN BÜROMÖBEL\").\n3. Return **1** if the input matches any company name in the list based on the above criteria.\n4. Return **0** if the input does not match any company name.\n5. Do not return any other output, explanation, or text."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        2420,
        400
      ],
      "id": "8b3413bc-8bfb-4d20-adab-bbc48050a8dc",
      "name": "AI Agent14",
      "retryOnFail": false,
      "executeOnce": true,
      "alwaysOutputData": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "amount": 1
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        4560,
        400
      ],
      "id": "20e644db-a243-4ff5-989f-3292de147b24",
      "name": "Wait4",
      "webhookId": "f2dc6a25-85fa-4757-9743-498bec5b435b"
    },
    {
      "parameters": {
        "url": "={{ $('setScriptUrl').first().json.url }}",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "script",
              "value": "isPrivatUser"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -280,
        420
      ],
      "id": "7a61b3d7-62c5-475a-b875-d952af6a46bb",
      "name": "deletePrivatUsers"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "dc6035de-28b8-4a1f-a7a6-89fec3f568f3",
              "name": "url",
              "value": "https://script.google.com/macros/s/AKfycby8tCQNpr0UT9-STVbn8MNVAoc8AXoDNSeZzlM6244QUvq4tQxBUMRapMRT-vP-B_s4NA/exec",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1040,
        420
      ],
      "id": "5be53416-5457-461e-8de9-8ac1187d98ae",
      "name": "setScriptUrl"
    },
    {
      "parameters": {
        "url": "={{ $('setScriptUrl').first().json.url }}",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "script",
              "value": "isAlreadyPartnerCompany"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -720,
        420
      ],
      "id": "999c3eb7-bc18-4497-aadb-17f1f59636f0",
      "name": "deletePartnersByCompany"
    },
    {
      "parameters": {
        "url": "={{ $('setScriptUrl').first().json.url }}",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "script",
              "value": "isAlreadyPartnerEmail"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -500,
        420
      ],
      "id": "e5117199-67a9-405f-81a3-00d00474a546",
      "name": "isAlreadyPartnerEmail"
    },
    {
      "parameters": {
        "url": "={{ $('setScriptUrl').first().json.url }}",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "script",
              "value": "noPhoneNumber"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1920,
        7120
      ],
      "id": "d0cec7fd-1bd3-44c5-8478-e30097eba56e",
      "name": "deleteNoPhoneNumbers",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "url": "https://google.serper.dev/search",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "q",
              "value": "={{ \n  $('Loop Over Items6').first().json['Company'] || 'Kein Company-Name' \n}}  \n{{ \n  (() => {\n    const raw = $('Loop Over Items6').first().json?.Address || '';\n    const match = raw.match(/\\b\\d{5}\\b/);\n    return match ? match[0] : '';\n  })() \n}} {{ $('Loop Over Items6').first().json.Country }} telefonnummer\n"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "X-API-KEY",
              "value": "4ff0d5d9bf4ba4ca7779a75c034f12fbf1fd8e92"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        3940,
        4540
      ],
      "id": "c2252e7f-55bc-487a-98f3-20ddef1c1649",
      "name": "HTTP Request9"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "Replace Me6",
      "typeVersion": 1,
      "position": [
        6620,
        5420
      ],
      "id": "2488d539-e2ed-4d38-99c5-e2d452f74472"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4o-mini",
          "mode": "list",
          "cachedResultName": "gpt-4o-mini"
        },
        "options": {
          "temperature": 0
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        4140,
        5280
      ],
      "id": "3032dfdc-611c-4a0d-b2c4-f964283f3d61",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "F4TTzvzjjYGqOAGL",
          "name": "KS-Media"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.answerBox.title }} {{ $json.answerBox.answer }};;; {{ $json.organic[0].title }}{{ $json.organic[0].snippet }};;;{{ $json.organic[2].title }}{{ $json.organic[2].snippet }};;;{{ $json.organic[3].title }}{{ $json.organic[3].snippet }};;;",
        "options": {
          "systemMessage": "=Du bist ein spezialisierter Filter für Telefonnummern von Firmen. Deine Aufgabe ist es, die Telefonnummer der Firma {{ $('Loop Over Items6').first().json.Company }} in {{ $('Loop Over Items6')?.first()?.json.Address && $('Loop Over Items6')?.first()?.json.Address.match(/,\\s*(.*)/) ? $('Loop Over Items6')?.first()?.json.Address.match(/,\\s*(.*)/)[1] : '' }}\n {{ $('Loop Over Items6').first().json.Country }} aus den gegebenen Suchergebnissen zu extrahieren. \n\n## Regeln:\n1. Die Suchergebnisse sind durch `;;;` getrennt.\n2. Gib nur die Telefonnummer aus dem ersten Ergebnis zurück, falls sie vorhanden ist. Falls im ersten Ergebnis keine gültige Telefonnummer enthalten ist, suche im zweiten.\n3. Stelle sicher, dass die gefundene Telefonnummer auch wirklich der Firma {{ \n  $('Loop Over Items6').first().json['Company'] || 'Kein Company-Name' \n}}  \n{{ \n  (() => {\n    const raw = $('Loop Over Items6').item.json?.Address || '';\n    const match = raw.match(/\\b\\d{5}\\b/);\n    return match ? match[0] : '';\n  })() \n}} {{ $('Loop Over Items6').item.json.Country }} zugeordnet ist. Achte besonders darauf, dass die Telefonnummer aus einer verlässlichen Quelle stammt und der Firma zugeordnet werden kann.\n4. Wenn keine gültige Telefonnummer gefunden wird, gib none zurück.\n\nGib nur die Telefonnummer zurück mit zwei einzigen kurzen worten das beschreibt wo du sie gefunden hast und zu wem sie gehört. Wenn du dazu keine Information hast schreibe \"allgemein\". Keine weiteren Informationen. z.B.\nAnna Schuhmann: +49 44040033003\nallgemein: 40400404\n\nwenn du keine passende Telefonnummer findest gebe nur none zurrück und sonst nichts "
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        4140,
        4540
      ],
      "id": "24aa8489-0cd3-45b5-92c5-bf81b0d35855",
      "name": "AI Agent15",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "df41ef12-68ad-48d2-9ab4-6a7423818213",
              "leftValue": "={{ $json.output }}",
              "rightValue": "none",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        4620,
        4540
      ],
      "id": "859b06fe-ff82-4d2b-9042-14b371609d26",
      "name": "If14"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI",
          "mode": "list",
          "cachedResultName": "K&S-Automation-Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 211066673,
          "mode": "list",
          "cachedResultName": "Tabellenblatt1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit#gid=211066673"
        },
        "options": {
          "returnFirstMatch": true
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        520,
        5440
      ],
      "id": "e2a269bc-5faf-4b61-9ff9-f6e3ad426f5a",
      "name": "Google Sheets",
      "executeOnce": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Pld7csTWl31TEr2y",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "6c478565-ae01-4b2d-878f-b2f53ce7d86a",
              "leftValue": "={{ $('Loop Over Items6').first().json.CompanyPhone }}",
              "rightValue": "\"allgemein: allgemein\"",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2300,
        5440
      ],
      "id": "b7da438a-6f45-4217-bea9-5fa03c77c17c",
      "name": "isEmailPrivat"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "a9df6e10-1820-4457-b950-e078d45ff0fe",
              "leftValue": "={{ $('Loop Over Items6').first().json.Company.toString() }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        3020,
        4660
      ],
      "id": "5d75fa36-5ae7-45f6-87e3-903ebe286a5f",
      "name": "If15"
    },
    {
      "parameters": {
        "options": {
          "reset": false
        }
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        800,
        5440
      ],
      "id": "cc233ff2-f80f-4d76-a15e-237452e19808",
      "name": "Loop Over Items6"
    },
    {
      "parameters": {
        "url": "https://google.serper.dev/search",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "q",
              "value": "={{ \n  $('Loop Over Items6').first().json['E-Mail'] \n    ? $('Loop Over Items6').first().json['E-Mail'].split(\"@\")[1] \n    : '' \n}} {{ (() => {\n    const raw = $('Loop Over Items6').first().json?.Address || '';\n    const match = raw.match(/\\b\\d{5}\\b/);\n    return match ? match[0] : '';\n  })() \n}} {{ $('Loop Over Items6').first().json.Country }} telefonnummer \n"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "X-API-KEY",
              "value": "4ff0d5d9bf4ba4ca7779a75c034f12fbf1fd8e92"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        3940,
        4780
      ],
      "id": "a820ca74-b080-4766-b9ab-ece040d4109d",
      "name": "HTTP Request10"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.answerBox.title }} {{ $json.answerBox.answer }};;; {{ $json.organic[0].title }}{{ $json.organic[0].snippet }};;;{{ $json.organic[2].title }}{{ $json.organic[2].snippet }};;;{{ $json.organic[3].title }}{{ $json.organic[3].snippet }};;;",
        "options": {
          "systemMessage": "=Du bist ein spezialisierter Filter für Telefonnummern von Firmen. Deine Aufgabe ist es, die Telefonnummer der Firma {{ $('Loop Over Items6').first().json.Company }} in {{ $('Loop Over Items6')?.first()?.json.Address && $('Loop Over Items6')?.first()?.json.Address.match(/,\\s*(.*)/) ? $('Loop Over Items6')?.first()?.json.Address.match(/,\\s*(.*)/)[1] : '' }}\n {{ $('Loop Over Items6').first().json.Country }} aus den gegebenen Suchergebnissen zu extrahieren. \n\n## Regeln:\n1. Die Suchergebnisse sind durch `;;;` getrennt.\n2. Gib nur die Telefonnummer aus dem ersten Ergebnis zurück, falls sie vorhanden ist. Falls im ersten Ergebnis keine gültige Telefonnummer enthalten ist, suche im zweiten.{{ \n  $('Loop Over Items6').first().json['E-Mail'] \n    ? $('Loop Over Items6').item.json['E-Mail'].split(\"@\")[1] \n    : '' \n}} {{ (() => {\n    const raw = $('Loop Over Items6').first().json?.Address || '';\n    const match = raw.match(/\\b\\d{5}\\b/);\n    return match ? match[0] : '';\n  })() \n}}  {{ $('Loop Over Items6').item.json.Country }}\n zugeordnet ist. Achte besonders darauf, dass die Telefonnummer aus einer verlässlichen Quelle stammt und der Firma zugeordnet werden kann.\n4. Wenn keine gültige Telefonnummer gefunden wird, gib none zurück.\n\nGib nur die Telefonnummer zurück mit zwei einzigen kurzen worten das beschreibt wo du sie gefunden hast und zu wem sie gehört. Wenn du dazu keine Information hast schreibe \"allgemein\". Keine weiteren Informationen. z.B.\nAnna Schuhmann: +49 44040033003\nallgemein: 40400404\n\nwenn du keine passende Telefonnummer findest gebe nur none zurrück und sonst nichts \n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        4240,
        4800
      ],
      "id": "3bbfb42d-82ad-4e2a-8379-79c29d6eaefe",
      "name": "AI Agent16",
      "alwaysOutputData": true,
      "executeOnce": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "df41ef12-68ad-48d2-9ab4-6a7423818213",
              "leftValue": "={{ $json.output }}",
              "rightValue": "none",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        4620,
        4780
      ],
      "id": "16a00a94-a7dc-4668-a2a8-daa4165e7c43",
      "name": "If16"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI",
          "mode": "list",
          "cachedResultName": "K&S-Automation-Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 211066673,
          "mode": "list",
          "cachedResultName": "Tabellenblatt1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit#gid=211066673"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": "={{ $('Loop Over Items6').first().json.row_number}}",
            "CompanyPhone": "={{ JSON.stringify($('AI Agent16').first().json.output) }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "Date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Time",
              "displayName": "Time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "User-IP",
              "displayName": "User-IP",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Form-Language",
              "displayName": "Form-Language",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Salutation",
              "displayName": "Salutation",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "First name",
              "displayName": "First name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Company",
              "displayName": "Company",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Address",
              "displayName": "Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Country",
              "displayName": "Country",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "E-Mail",
              "displayName": "E-Mail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Newsletter",
              "displayName": "Newsletter",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "How did you become attentive on the pCon.planner",
              "displayName": "How did you become attentive on the pCon.planner",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "I use the pCon.planner as",
              "displayName": "I use the pCon.planner as",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Version",
              "displayName": "Version",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Edition",
              "displayName": "Edition",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "CompanyPhone",
              "displayName": "CompanyPhone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        5140,
        4760
      ],
      "id": "7130b445-24d4-4af6-99bf-b45b85eba27a",
      "name": "Google Sheets18",
      "executeOnce": true,
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Pld7csTWl31TEr2y",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "content": "# Find company phonenumber in Impressum or on Website\n\n",
        "height": 1220,
        "width": 6700,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -60,
        5680
      ],
      "typeVersion": 1,
      "id": "e9daafcf-1ab1-4029-957d-23c92b7d76b7",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "# Find company phonenumber by google search\n\n",
        "height": 1220,
        "width": 6700,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -60,
        4480
      ],
      "typeVersion": 1,
      "id": "f3b7ea79-93a6-4752-9dda-c27da07b4cc1",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI",
          "mode": "list",
          "cachedResultName": "K&S-Automation-Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 211066673,
          "mode": "list",
          "cachedResultName": "Tabellenblatt1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit#gid=211066673"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": "={{ $('Loop Over Items6').first().json.row_number}}",
            "CompanyPhone": "={{ JSON.stringify($('AI Agent15').first().json.output) }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "Date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Time",
              "displayName": "Time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "User-IP",
              "displayName": "User-IP",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Form-Language",
              "displayName": "Form-Language",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Salutation",
              "displayName": "Salutation",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "First name",
              "displayName": "First name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Company",
              "displayName": "Company",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Address",
              "displayName": "Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Country",
              "displayName": "Country",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "E-Mail",
              "displayName": "E-Mail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Newsletter",
              "displayName": "Newsletter",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "How did you become attentive on the pCon.planner",
              "displayName": "How did you become attentive on the pCon.planner",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "I use the pCon.planner as",
              "displayName": "I use the pCon.planner as",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Version",
              "displayName": "Version",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Edition",
              "displayName": "Edition",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "CompanyPhone",
              "displayName": "CompanyPhone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        5260,
        4540
      ],
      "id": "f0d019ba-62f3-4828-96e4-91835093fb26",
      "name": "Google Sheets24",
      "executeOnce": true,
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Pld7csTWl31TEr2y",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4o-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        2620,
        2620
      ],
      "id": "ad30c780-1841-478a-8003-8fed51716be9",
      "name": "OpenAI Chat Model2",
      "credentials": {
        "openAiApi": {
          "id": "F4TTzvzjjYGqOAGL",
          "name": "KS-Media"
        }
      }
    },
    {
      "parameters": {
        "url": "={{ $('setScriptUrl').first().json.url }}",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "script",
              "value": "sortSheet"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2180,
        7120
      ],
      "id": "fa30d692-4e43-40ce-9fb1-adac12fc6a59",
      "name": "sortSheet",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "amount": 60
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -380,
        2080
      ],
      "id": "51b0ec3d-5ac0-468d-9856-c5e7da4af102",
      "name": "Wait",
      "webhookId": "122e4e29-b135-46f6-b061-cf3ff33063c9"
    },
    {
      "parameters": {
        "amount": 300
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        200,
        3700
      ],
      "id": "bb135f5f-fbca-4f42-a1cc-a08e144f8a14",
      "name": "Wait1",
      "webhookId": "abddafdf-6650-4aca-b6d6-63546859cdd5"
    },
    {
      "parameters": {
        "amount": 60
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        260,
        5440
      ],
      "id": "81dd7a2c-d40b-418f-bfcd-85033cb881b9",
      "name": "Wait5",
      "webhookId": "bd31afae-5bf9-4122-8a98-e6023a4a71e6"
    },
    {
      "parameters": {
        "amount": 60
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        220,
        6540
      ],
      "id": "d62a003b-f7cc-4671-8b6d-88b0169c943a",
      "name": "Wait6",
      "webhookId": "3d7eafec-54db-4644-8084-dfdc8415af25"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI",
          "mode": "list",
          "cachedResultName": "K&S-Automation-Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1135880709,
          "mode": "list",
          "cachedResultName": "RowsToDelete",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit#gid=1135880709"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Date": "={{ $('Loop Over Items5').item.json.Date }}",
            "Time": "={{ $('Loop Over Items5').item.json.Time }}",
            "User-IP": "={{ $('Loop Over Items5').item.json['User-IP'] }}",
            "Form-Language": "={{ $('Loop Over Items5').item.json['Form-Language'] }}",
            "Salutation": "={{ $('Loop Over Items5').item.json.Salutation }}",
            "First name": "={{ $('Loop Over Items5').item.json['First name'] }}",
            "Name": "={{ $('Loop Over Items5').item.json.Name }}",
            "Company": "={{ $('Loop Over Items5').item.json.Company }}",
            "Address": "={{ $('Loop Over Items5').item.json.Address }}",
            "Country": "={{ $('Loop Over Items5').item.json.Country }}",
            "E-Mail": "={{ $('Loop Over Items5').item.json['E-Mail'] }}",
            "Newsletter": "={{ $('Loop Over Items5').item.json.Newsletter }}",
            "How did you become attentive on the pCon.planner": "={{ $('Loop Over Items5').item.json['How did you become attentive on the pCon.planner'] }}",
            "I use the pCon.planner as": "={{ $('Loop Over Items5').item.json['I use the pCon.planner as'] }}",
            "Version": "={{ $('Loop Over Items5').item.json.Version }}",
            "Edition": "={{ $('Loop Over Items5').item.json.Edition }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "Date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Time",
              "displayName": "Time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "User-IP",
              "displayName": "User-IP",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Form-Language",
              "displayName": "Form-Language",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Salutation",
              "displayName": "Salutation",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "First name",
              "displayName": "First name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Company",
              "displayName": "Company",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Address",
              "displayName": "Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Country",
              "displayName": "Country",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "E-Mail",
              "displayName": "E-Mail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Newsletter",
              "displayName": "Newsletter",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "How did you become attentive on the pCon.planner",
              "displayName": "How did you become attentive on the pCon.planner",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "I use the pCon.planner as",
              "displayName": "I use the pCon.planner as",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Version",
              "displayName": "Version",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Edition",
              "displayName": "Edition",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "branche",
              "displayName": "branche",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        3380,
        320
      ],
      "id": "e7e22b57-a754-4ca3-bbd5-9b29ee8dcdd3",
      "name": "Google Sheets25",
      "executeOnce": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Pld7csTWl31TEr2y",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "df41ef12-68ad-48d2-9ab4-6a7423818213",
              "leftValue": "={{ $('AI Agent14').first().json.output }}",
              "rightValue": "1",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2880,
        400
      ],
      "id": "d43be260-d276-4d47-aa73-d88893568026",
      "name": "If17"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI",
          "mode": "list",
          "cachedResultName": "K&S-Automation-Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 211066673,
          "mode": "list",
          "cachedResultName": "Tabellenblatt1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit#gid=211066673"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "E-Mail": "={{ $('Loop Over Items').first().json['E-Mail'] }}",
            "branche": "={{ $('AI Agent9').first().json.output }}"
          },
          "matchingColumns": [
            "E-Mail"
          ],
          "schema": [
            {
              "id": "Date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Time",
              "displayName": "Time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "User-IP",
              "displayName": "User-IP",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Form-Language",
              "displayName": "Form-Language",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Salutation",
              "displayName": "Salutation",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "First name",
              "displayName": "First name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Company",
              "displayName": "Company",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Address",
              "displayName": "Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Country",
              "displayName": "Country",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "E-Mail",
              "displayName": "E-Mail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Newsletter",
              "displayName": "Newsletter",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "How did you become attentive on the pCon.planner",
              "displayName": "How did you become attentive on the pCon.planner",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "I use the pCon.planner as",
              "displayName": "I use the pCon.planner as",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Version",
              "displayName": "Version",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Edition",
              "displayName": "Edition",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "branche",
              "displayName": "branche",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        3720,
        1960
      ],
      "id": "757e0c4f-54df-44c9-b9aa-e48be51daf22",
      "name": "Google Sheets2",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Pld7csTWl31TEr2y",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI",
          "mode": "list",
          "cachedResultName": "K&S-Automation-Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 211066673,
          "mode": "list",
          "cachedResultName": "Tabellenblatt1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit#gid=211066673"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "E-Mail": "={{ $('Loop Over Items').first().json['E-Mail'] }}",
            "branche": "={{ $('AI Agent1').first().json.output }}"
          },
          "matchingColumns": [
            "E-Mail"
          ],
          "schema": [
            {
              "id": "Date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Time",
              "displayName": "Time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "User-IP",
              "displayName": "User-IP",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Form-Language",
              "displayName": "Form-Language",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Salutation",
              "displayName": "Salutation",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "First name",
              "displayName": "First name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Company",
              "displayName": "Company",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Address",
              "displayName": "Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Country",
              "displayName": "Country",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "E-Mail",
              "displayName": "E-Mail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Newsletter",
              "displayName": "Newsletter",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "How did you become attentive on the pCon.planner",
              "displayName": "How did you become attentive on the pCon.planner",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "I use the pCon.planner as",
              "displayName": "I use the pCon.planner as",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Version",
              "displayName": "Version",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Edition",
              "displayName": "Edition",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "CompanyPhone",
              "displayName": "CompanyPhone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "branche",
              "displayName": "branche",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        3740,
        1620
      ],
      "id": "85e05ba8-2020-48a7-8396-0cd08c4e7ec8",
      "name": "Google Sheets4",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Pld7csTWl31TEr2y",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "6c478565-ae01-4b2d-878f-b2f53ce7d86a",
              "leftValue": "={{ $('Loop Over Items').first().json['E-Mail'].toString() }}",
              "rightValue": "^[\\w\\.-]+@(gmail|t\\-online|cloud|ooglemail|test|googlemail|yahoo|ymail|rocketmail|hotmail|outlook|live|msn|icloud|me|mac|aol|mail|zoho|gmx|web|t-online|freenet|email|arcor|vodafone|alice|versanet|kabelmail|online|ewetel|protonmail|proton|tutanota|posteo|runbox|mailfence|startmail|fastmail|hushmail|mailbox|bluewin|sunrise|swissonline|hispeed|laposte|libero|tin|seznam|mail\\.ru|yandex|inbox\\.ru|bk\\.ru|list\\.ru|qq|126|163|sina|naver|daum|gawab|cox|comcast|bellsouth|verizon|berlin|aon|inode|chello|utanet|tele2|eduhi|liwest|netcologne|example|seml|mailinator|pm|clonemailsieure|anonymous|duck)\\.[a-zA-Z]{2,}$",
              "operator": {
                "type": "string",
                "operation": "regex"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1320,
        2140
      ],
      "id": "e95b34d3-8f19-452a-909f-f879ac261dd8",
      "name": "isEmailPrivat4"
    },
    {
      "parameters": {
        "url": "={{ $('Loop Over Items').first().json['E-Mail'] ? \"http://www.\" + $('Loop Over Items').first().json['E-Mail'].split(\"@\")[1] : '' }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1860,
        2100
      ],
      "id": "6a10e076-96ad-4621-a46f-ff3589e3ef7e",
      "name": "HTTP Request5",
      "alwaysOutputData": false,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "// Zugriff auf die HTML-Daten aus der Eingabevariable\nconst htmlContent = $('HTTP Request5').first().json.data;\n\n// Funktion zum Entfernen von HTML-Tags, JavaScript, CSS und Bereinigen des Textes\nfunction cleanHtml(html) {\n  // Entferne <script> und <style> Tags samt Inhalt\n  html = html.replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi, '');\n  html = html.replace(/<style\\b[^<]*(?:(?!<\\/style>)<[^<]*)*<\\/style>/gi, '');\n  \n  // Entferne alle HTML-Tags, behalte den Text dazwischen\n  html = html.replace(/<[^>]+>/g, '');\n  \n  // Entferne überflüssige Leerzeichen, Tabs und Zeilenumbrüche\n  html = html.replace(/\\s+/g, ' ').trim();\n  \n  // Entferne HTML-Entities (z. B.  , &)\n  html = html.replace(/&[a-zA-Z0-9#]+;/g, '');\n\n  return html;\n}\n\n// Funktion zum Komprimieren und Filtern auf relevante Unternehmensinhalte\nfunction compressBusinessContent(text) {\n  // Liste von Stoppwörtern/Phrasen, die oft irrelevant sind\n  const irrelevantPhrases = [\n    'kontakt', 'impressum', 'datenschutz', 'agb', 'newsletter', 'login', 'registrieren',\n    'folgen sie uns', 'social media', 'copyright', 'all rights reserved', 'sitemap'\n  ];\n  \n  // Erweiterte Schlüsselwörter für Unternehmensaktivitäten, inkl. Bürospezifika und Akustik\n  const businessKeywords = [\n    'dienstleistungen', 'services', 'produkte', 'lösungen', 'angebot', 'portfolio',\n    'automatisierung', 'unterstützung', 'support', 'technologie', 'entwicklung',\n    'herstellung', 'verkauf', 'beratung', 'consulting', 'training', 'schulung',\n    // Bürospezifische Begriffe\n    'büro', 'arbeitsplatz', 'büroausstattung', 'möbel', 'ergonomie', 'büroplanung',\n    'arbeitsumgebung', 'office', 'arbeitsstation', 'einrichtung', 'bürodesign',\n    // Akustikbezogene Begriffe\n    'akustik', 'schallschutz', 'schallabsorption', 'raumakustik', 'lärmschutz',\n    'akustiklösungen', 'schalldämmung', 'akustikpaneele', 'schalloptimierung',\n    // Allgemeine Lösungsbegriffe\n    'optimierung', 'systeme', 'integration', 'effizienz', 'prozesse', 'management',\n    'software', 'hardware', 'innovation', 'maßgeschneidert', 'lösungsanbieter',\n    'qualität', 'zuverlässigkeit', 'nachhaltigkeit'\n  ];\n\n  // Text in Sätze aufteilen (nach Punkten, aber Leerzeichen beibehalten)\n  const sentences = text.split('. ').map(s => s.trim());\n\n  // Filtere Sätze:\n  // - Behalte alle Sätze, die keine irrelevantPhrases enthalten\n  const relevantSentences = sentences.filter(sentence => {\n    const lowerSentence = sentence.toLowerCase();\n    const hasIrrelevantPhrase = irrelevantPhrases.some(phrase => lowerSentence.includes(phrase));\n    return !hasIrrelevantPhrase;\n  });\n\n  // Sortiere Sätze: Sätze mit businessKeywords zuerst\n  const sortedSentences = relevantSentences.sort((a, b) => {\n    const lowerA = a.toLowerCase();\n    const lowerB = b.toLowerCase();\n    const hasKeywordA = businessKeywords.some(keyword => lowerA.includes(keyword));\n    const hasKeywordB = businessKeywords.some(keyword => lowerB.includes(keyword));\n    return hasKeywordB - hasKeywordA; // Sätze mit Keywords nach vorne\n  });\n\n  // Verbinde die relevanten Sätze und begrenze die Länge (max. 5000 Zeichen)\n  let compressedText = sortedSentences.join('. ').trim();\n  if (compressedText.length > 5000) {\n    compressedText = compressedText.substring(0, 4997) + '...';\n  }\n\n  // Falls kein relevanter Inhalt gefunden wurde, gib eine Standardmeldung zurück\n  return compressedText || 'Keine spezifischen Informationen zu Unternehmensaktivitäten gefunden.';\n}\n\n// Bereinigten Text verarbeiten\nconst cleanedText = cleanHtml(htmlContent);\n\n// Komprimierten Text mit Fokus auf Unternehmensinhalte erstellen\nconst compressedText = compressBusinessContent(cleanedText);\n\n// Rückgabe im n8n-Format\nreturn [{ json: { compressedText: compressedText } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2820,
        2280
      ],
      "id": "d5524e3d-0a47-4d65-a6f7-f97fee5220cc",
      "name": "Code"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "f8ff70cb-6498-4be8-9084-a836673de9b8",
              "leftValue": "={{ $('HTTP Request5').first().json.data }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notExists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2200,
        2100
      ],
      "id": "ca03597f-21b4-4d35-b0d0-9939954db1e7",
      "name": "If"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('AI Agent8').first().json.output }}",
        "options": {
          "systemMessage": "Du bist ein hochqualifizierter Firmenklassifizierer und Rechercheur mit Zugriff auf zuverlässige Datenquellen.\nDeine Aufgabe ist es, ein Unternehmen anhand des Firmennamens und einer kurzen Tätigkeitsbeschreibung kontextbezogen zu bewerten.\n\nZu berücksichtigende Branchen\n\nAkustik (Raumakustik, Schalldämmung, Beschallungstechnik, Audio)\nBüro (Büroplanung, Büromöbel, Büro‑Trennwände, Drucker, Druckerverleih, Bürostühle, Bürotische, Büro‑IT)\nName als Indikator\n\nEgal, ob Dienstleistung, Produkt, Entwicklung, Verkauf, Vermietung oder Beratung – zählt nur, ob das Hauptgeschäft ausschließlich oder hauptsächlich in einer oder beiden dieser Branchen liegt.\n\nEnthält der Firmenname ausschließlich Keywords aus Akustik oder Bürobranche (z. B. „Büroplaner GmbH“, „Akustikmeister GmbH“), wertet das stark für 1.\nVerknüpft der Name Zielbranchen mit anderen Bereichen (z. B. „Akustik und Fitnessgeräte GmbH“), gilt das als 0.\nFehlen im Namen Treffer, bewerte nur anhand der Tätigkeitsbeschreibung.\nEntscheidungsregeln\n\n1, wenn Name und/oder jede genannte Tätigkeit ausschließlich oder überwiegend zu Akustik und/oder Büro­branche gehört.\n0, sobald Name oder mindestens eine Tätigkeit klar nicht dazugehört (z. B. Schultische, Fußballklamotten, Festivaltechnik).\n1, wenn Tätigkeiten unklar sind, aber eindeutige Keywords aus Zielbranchen vorliegen und der Name nicht widerspricht.\n0, wenn es sich lediglich um einen normalen Möbelhändler ohne spezifischen Büro­bezug handelt.\nWichtig\n\nVerstehe Zusammenhänge: „Druckerverleih“ zählt zu Bürobranche; „Schultische“ nicht.\nBeurteile ganzheitlich: Name + Beschreibung müssen passen.\nGib nur den Integer 0 oder 1 zurück – keine Erklärungen, Kommentare oder zusätzlichen Text.\nInput\n– Firmenname\n– Tätigkeitsbeschreibung (Liste, z. B. „Büromöbelverkauf, Druckerverleih, Raumakustik-Planung“)\n\nOutput\n\n0 oder 1"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        3440,
        2280
      ],
      "id": "d5481fd6-4556-42c1-bb3f-83ffb2614773",
      "name": "AI Agent7"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Code').first().json.compressedText }}",
        "options": {
          "systemMessage": "Du bist ein hochqualifizierter Firmenklassifizierer und Rechercheur mit Zugriff auf zuverlässige Datenquellen.\nDeine Aufgabe ist es, ein Unternehmen anhand des Firmennamens und einer kurzen Tätigkeitsbeschreibung präzise zu analysieren.\n\nAnleitung:\n\nNutze sowohl Firmennamen als auch Tätigkeitsbeschreibung, um die tatsächlichen Kerntätigkeiten zu ermitteln.\nGib so viele der wichtigsten Tätigkeiten aus, wie tatsächlich vorhanden sind (mindestens 2, maximal 5).\nFormuliere jede Tätigkeit als Stichpunkt mit 3–5 Wörtern.\nKeine Branchenbezeichnungen, Einordnungen, Erklärungen oder Zusatzinfos.\nKeine Wiederholungen oder Synonyme.\nDie Ausgabe ist eine durch Kommas getrennte Liste der Stichpunkte.\nBeispielausgaben:\n\n„Büromöbelverkauf, Festivalorganisation, Hörgeräteanpassung, Grafikdesign, Immobilienvermittlung“\n„Hörgeräteberatung, Schalldämmungssysteme, Konferenzmikrofontechnik“\n„Ergonomische Bürostühle, Akustikdeckenmontage, Schulmöbelproduktion“"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        3080,
        2280
      ],
      "id": "6e85f68b-7eb5-42b9-9f12-9ed270d760da",
      "name": "AI Agent8"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI",
          "mode": "list",
          "cachedResultName": "K&S-Automation-Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1135880709,
          "mode": "list",
          "cachedResultName": "RowsToDelete",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit#gid=1135880709"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "User-IP": "={{ $('Loop Over Items').first().json['User-IP'] }}",
            "Date": "={{ $('Loop Over Items').first().json.Date }}",
            "Time": "={{ $('Loop Over Items').first().json.Time }}",
            "Form-Language": "={{ $('Loop Over Items').first().json['Form-Language'] }}",
            "First name": "={{ $('Loop Over Items').first().json['First name'] }}",
            "Salutation": "={{ $('Loop Over Items').first().json.Salutation }}",
            "Name": "={{ $('Loop Over Items').first().json.Name }}",
            "Company": "={{ $('Loop Over Items').first().json.Company }}",
            "Address": "={{ $('Loop Over Items').first().json.Address }}",
            "Country": "={{ $('Loop Over Items').first().json.Country }}",
            "E-Mail": "={{ $('Loop Over Items').first().json['E-Mail'] }}",
            "Newsletter": "={{ $('Loop Over Items').first().json.Newsletter }}",
            "How did you become attentive on the pCon.planner": "={{ $('Loop Over Items').first().json['How did you become attentive on the pCon.planner'] }}",
            "I use the pCon.planner as": "={{ $('Loop Over Items').first().json['I use the pCon.planner as'] }}",
            "Version": "={{ $('Loop Over Items').first().json.Version }}",
            "Edition": "={{ $('Loop Over Items').first().json.Edition }}",
            "branche": "={{ $('AI Agent8').first().json.output }}"
          },
          "matchingColumns": [
            "User-IP"
          ],
          "schema": [
            {
              "id": "Date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Time",
              "displayName": "Time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "User-IP",
              "displayName": "User-IP",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Form-Language",
              "displayName": "Form-Language",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Salutation",
              "displayName": "Salutation",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "First name",
              "displayName": "First name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Company",
              "displayName": "Company",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Address",
              "displayName": "Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Country",
              "displayName": "Country",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "E-Mail",
              "displayName": "E-Mail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Newsletter",
              "displayName": "Newsletter",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "How did you become attentive on the pCon.planner",
              "displayName": "How did you become attentive on the pCon.planner",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "I use the pCon.planner as",
              "displayName": "I use the pCon.planner as",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Version",
              "displayName": "Version",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Edition",
              "displayName": "Edition",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "branche",
              "displayName": "branche",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        4600,
        2200
      ],
      "id": "2c63cffc-6b3d-4f41-8884-e77928978464",
      "name": "Google Sheets5",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Pld7csTWl31TEr2y",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "df41ef12-68ad-48d2-9ab4-6a7423818213",
              "leftValue": "={{ $('AI Agent7').first().json.output }}",
              "rightValue": "1",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        3960,
        2260
      ],
      "id": "cbe914fd-bbbf-4010-b7c1-847abab8bfcc",
      "name": "If2"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI",
          "mode": "list",
          "cachedResultName": "K&S-Automation-Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 211066673,
          "mode": "list",
          "cachedResultName": "Tabellenblatt1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit#gid=211066673"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "E-Mail": "={{ $('Loop Over Items').first().json['E-Mail'] }}",
            "branche": "={{ $('AI Agent8').first().json.output }}"
          },
          "matchingColumns": [
            "E-Mail"
          ],
          "schema": [
            {
              "id": "Date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Time",
              "displayName": "Time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "User-IP",
              "displayName": "User-IP",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Form-Language",
              "displayName": "Form-Language",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Salutation",
              "displayName": "Salutation",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "First name",
              "displayName": "First name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Company",
              "displayName": "Company",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Address",
              "displayName": "Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Country",
              "displayName": "Country",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "E-Mail",
              "displayName": "E-Mail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Newsletter",
              "displayName": "Newsletter",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "How did you become attentive on the pCon.planner",
              "displayName": "How did you become attentive on the pCon.planner",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "I use the pCon.planner as",
              "displayName": "I use the pCon.planner as",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Version",
              "displayName": "Version",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Edition",
              "displayName": "Edition",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "CompanyPhone",
              "displayName": "CompanyPhone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "branche",
              "displayName": "branche",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        4420,
        2320
      ],
      "id": "6a5b1837-9dd5-481d-9a91-c8770614a44e",
      "name": "Google Sheets6",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Pld7csTWl31TEr2y",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Zugriff auf die HTML-Daten aus der Eingabevariable\nconst htmlContent1 = $('HTTP Request2').first().json.data || '';\nconst htmlContent2 = $('HTTP Request3').first().json.data || '';\n\n// Funktion zum Entfernen von HTML-Tags, JavaScript, CSS und Bereinigen des Textes\nfunction cleanHtml(html) {\n  // Entferne <script> und <style> Tags samt Inhalt\n  html = html.replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi, '');\n  html = html.replace(/<style\\b[^<]*(?:(?!<\\/style>)<[^<]*)*<\\/style>/gi, '');\n  \n  // Entferne alle HTML-Tags, behalte den Text dazwischen\n  html = html.replace(/<[^>]+>/g, '');\n  \n  // Entferne überflüssige Leerzeichen, Tabs und Zeilenumbrüche\n  html = html.replace(/\\s+/g, ' ').trim();\n  \n  // Entferne HTML-Entities (z. B. &nbsp;, &amp;)\n  html = html.replace(/&[a-zA-Z0-9#]+;/g, '');\n\n  return html;\n}\n\n// Beide HTML-Inhalte bereinigen\nconst cleanedText1 = cleanHtml(htmlContent1);\nconst cleanedText2 = cleanHtml(htmlContent2);\n\n// Zusammenfügen oder Standardtext, wenn beide leer sind\nlet combinedCleanedText = '';\n\nif (cleanedText1 && cleanedText2) {\n  combinedCleanedText = `${cleanedText1} ${cleanedText2}`;\n} else if (cleanedText1) {\n  combinedCleanedText = cleanedText1;\n} else if (cleanedText2) {\n  combinedCleanedText = cleanedText2;\n} else {\n  combinedCleanedText = 'keine telefonnummer gefunden';\n}\n\n// Rückgabe des kombinierten Textes im n8n-Format\nreturn [{ json: { cleanedText: combinedCleanedText } }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3400,
        3720
      ],
      "id": "45a1a017-1116-4f0b-b311-1fe46bc9bcd7",
      "name": "Code1"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1420,
        3680
      ],
      "id": "e1c5dc74-a48f-4652-a581-e778433fd5e1",
      "name": "Wait7",
      "webhookId": "4d506278-0028-4c05-90eb-8e97b566d670"
    },
    {
      "parameters": {
        "url": "={{ $('setScriptUrl').first().json.url }}",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "script",
              "value": "DeleteRows"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -800,
        2120
      ],
      "id": "5c740c51-468a-42e6-8522-e4af5f316e1d",
      "name": "deleteRows1",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "url": "={{ $('setScriptUrl').first().json.url }}",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "script",
              "value": "DeleteRows"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -660,
        3420
      ],
      "id": "7053efc2-73f2-4200-ba98-f7a14c458af2",
      "name": "deleteRows2",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "fromEmail": "denny@redel-aisolutions.com",
        "toEmail": "denny@redel-aisolutions.com",
        "subject": "K&S Downloadliste",
        "emailFormat": "text",
        "text": "finished",
        "options": {}
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [
        2520,
        7120
      ],
      "id": "6d3dfcf1-af5e-4594-8d54-157fd638a49a",
      "name": "Send Email",
      "webhookId": "e83a8c64-1e29-40c9-965d-2d51f84409b8",
      "credentials": {
        "smtp": {
          "id": "CYZNGyn17Upg6wQ8",
          "name": "SMTP account Denny"
        }
      }
    },
    {
      "parameters": {
        "downloadAttachments": true,
        "options": {}
      },
      "type": "n8n-nodes-base.emailReadImap",
      "typeVersion": 2,
      "position": [
        -3260,
        380
      ],
      "id": "da38120a-e3de-473c-a592-f7e46b4fdce8",
      "name": "Email Trigger (IMAP)",
      "credentials": {
        "imap": {
          "id": "8TL1M6BmyANGSzjq",
          "name": "IMAP account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "73528cab-d0d6-47f7-be0a-c0045dab891b",
              "leftValue": "={{ $('Email Trigger (IMAP)').first().json.metadata['x-envelope-from'] }}",
              "rightValue": "<nw@einrichtungenplanen.de>",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            },
            {
              "id": "aff4b72a-57ca-4c15-9ccc-5410acf2249d",
              "leftValue": "={{ $('Email Trigger (IMAP)').first().json.subject }}",
              "rightValue": "pCon.planner Registrierungen",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -2980,
        380
      ],
      "id": "cf2555a2-f219-452e-9cd4-5456ac533988",
      "name": "If5"
    },
    {
      "parameters": {
        "operation": "xlsx",
        "binaryPropertyName": "attachment_0",
        "options": {
          "sheetName": "WOS-DE"
        }
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        -2600,
        580
      ],
      "id": "d0988d8f-bb46-41d4-8f13-314915b2fbb1",
      "name": "Extract from File"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -1340,
        580
      ],
      "id": "3661d34f-48a9-4c97-9554-a7d8f96abe5f",
      "name": "Loop Over Items1"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "Replace Me1",
      "typeVersion": 1,
      "position": [
        -900,
        600
      ],
      "id": "4513e020-698f-46a4-bf4b-5812fb975a6a"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI",
          "mode": "list",
          "cachedResultName": "K&S-Automation-Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 211066673,
          "mode": "list",
          "cachedResultName": "Tabellenblatt1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-pxibGJvkT5mVrD1Mb1Xj-0Bt56ZXj8pQST5LNq4pTI/edit#gid=211066673"
        },
        "options": {
          "dataLocationOnSheet": {
            "values": {
              "rangeDefinition": "detectAutomatically"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        -2360,
        580
      ],
      "id": "b8703ab8-7826-48bd-936c-650bf0f00c86",
      "name": "Google Sheets7",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Pld7csTWl31TEr2y",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "b66917a7-464c-4b1e-9018-df494b19c0ad",
              "leftValue": "={{ $('Google Sheets7').all()[$('Google Sheets7').all().length - 1].json.Date }}\n",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -2140,
        580
      ],
      "id": "41f58424-f828-4ee9-95f2-183e8b639dc3",
      "name": "If6"
    }
  ],
  "pinData": {
    "Email Trigger (IMAP)": [
      {
        "json": {
          "textHtml": "",
          "textPlain": "",
          "metadata": {
            "x-envelope-from": "<denny.redel@icloud.com>",
            "x-envelope-to": "<denny@redel-aisolutions.com>",
            "x-delivery-time": "1746630289",
            "x-uid": "1074",
            "return-path": "<denny.redel@icloud.com>",
            "arc-seal": "i=1; a=rsa-sha256; t=1746630289; cv=none;    d=strato.com; s=strato-dkim-0002;    b=lqTQP3HkdeuHwX06Jy6GfkFDi753Dg0yzeLW2zWo80BF7wuFrB4rXHu41rB3qQVLXE    GYpAIXESpkrjdKzb06KtcBvyEX2Xu2KcgY8fcN/6/x9zdn+UnPvfWvk467tO8grM06AO    1I3wkvJnTF7SbwC1w98rZsK9nGXgwPiAlE1FM/hkthDh/FX4yM/+EvkDydXH9g7cT886    DbyEkIfVXXE8ILjHwZQq1dUPV5qfDjFpMt9BfuX1OzwphkGJmdcEQnrZl8v4oSdqJFlT    bzYT8IWJvBBQJIdeNmLPYPhUb3SMvuRdjlmQ8OeSZt+7O8mWeh7BpSMkMcAaEKxd/iqk    DhzA==",
            "arc-message-signature": "i=1; a=rsa-sha256; c=relaxed/relaxed; t=1746630289;    s=strato-dkim-0002; d=strato.com;    h=To:Date:Message-Id:Subject:From:Cc:Date:From:Subject:Sender;    bh=meZF6stWdKU5pkBZSPXnaXvZLD+yuq3u485wMECz5CA=;    b=Yo+2Ho/t0D58LH/etm7kt/2wVQAHSmKfghCEoS7d1rzvvZxp2O/qc7M1uxuY5WB6h2    CDmOazqz3HRuTEA21PeAuB72SxH8iYS1BKwCbC4eMUOGPB9XSiYynR3c+Dp9YlUUs8Ak    MHhAeYrnFfuHFDeR4C1DMsT+2/wz74r5WSn568GpRApYvlkDcqVnnz+Sa0FTQ01BwSJa    d5tdcrXT9Gk3I/E89jjScr9yrixR0JpxcCz9NyM4/FgEiWX/xEEzvRDjw7XJCMXIzmX0    UqXdPD9iz3z6hzJ/62GqL0sWh8792OWufY8VOcI1YXSEq8aXK/yg29cROT2h5U5rwjHl    CDRQ==",
            "arc-authentication-results": "i=1; strato.com;    dmarc=pass (p=QUARANTINE sp=QUARANTINE) header.from=\"icloud.com\";    arc=none smtp.remote-ip=57.103.76.241;    dkim=pass header.d=\"icloud.com\" header.s=\"1a1hai\" header.a=\"rsa-sha256\";    dkim-adsp=pass;    spf=pass smtp.mailfrom=\"denny.redel@icloud.com\"",
            "authentication-results": "strato.com;    dmarc=pass (p=QUARANTINE sp=QUARANTINE) header.from=\"icloud.com\";    arc=none smtp.remote-ip=57.103.76.241;    dkim=pass header.d=\"icloud.com\" header.s=\"1a1hai\" header.a=\"rsa-sha256\";    dkim-adsp=pass;    spf=pass smtp.mailfrom=\"denny.redel@icloud.com\"",
            "x-rzg-expurgate": "clean/normal",
            "x-rzg-expurgate-id": "149500::1746630285-15606F3E-C989F8D5/0/0",
            "x-rzg-class-id": "mi00",
            "received-spf": "pass    (strato.com: domain icloud.com designates 57.103.76.241 as permitted sender)    mechanism=ip4;    client-ip=57.103.76.241;    helo=\"outbound.st.icloud.com\";    envelope-from=\"denny.redel@icloud.com\";    receiver=smtpin.rzone.de;    identity=mailfrom;",
            "received": "from outbound.st.icloud.com (p-east2-cluster6-host11-snip4-10.eps.apple.com [57.103.76.241])    by smtpin.rzone.de (RZmta 51.3.0 OK)    with ESMTPS id A3ccf9147F4iAG3    (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256 bits))    (Client did not present a certificate)    for <denny@redel-aisolutions.com>;    Wed, 7 May 2025 17:04:44 +0200 (CEST)",
            "dkim-signature": "v=1; a=rsa-sha256; c=relaxed/relaxed; d=icloud.com;\ts=1a1hai; bh=meZF6stWdKU5pkBZSPXnaXvZLD+yuq3u485wMECz5CA=;\th=From:Content-Type:Mime-Version:Subject:Message-Id:Date:To:x-icloud-hme;\tb=YSh9qEwEIM5uXHvfNy0p53i7VXL+kdHLLkLXMhCTSfFOeWCw2fVN8izU2uHsyGtmw\t NkzqYW1qgBInkEQuTPsWEiX5D7Isgkg66snC5pW7AXvmm+wjJRiPkpAnQNXopuVwCj\t wQccszqMI7Jfau870zVVFWocksi+9a3/eqVevZ6iFCb1h4bo8HSJ1Rx/QejfaBh72A\t gk6tqMV7BHaLn15WsvO5Owkj/G6abYhWIWq5Wl+B+W9rXydToGGGm1GnRUzOaL5urh\t 7JVVCQLLBnw4Yon8i3WXPTiGwxstjeq9e+4gaAtla7kHOwGpubE5OdWyU1CEBuBDV3\t /VzWnhoXuZH7g==",
            "content-type": "multipart/mixed;\tboundary=\"Apple-Mail=_5BF6BCCE-0C25-4649-A7ED-DEE98BAB6FE8\"",
            "mime-version": "1.0 (Mac OS X Mail 16.0 \\(3826.400.131.1.6\\))",
            "message-id": "<D1714DF0-1CAD-4265-B8E3-16B77CBA6E02@icloud.com>",
            "x-mailer": "Apple Mail (2.3826.400.131.1.6)",
            "x-proofpoint-orig-guid": "UXRPqpSS89WXtaj99BN-7IkqOnS-RDAs",
            "x-proofpoint-guid": "UXRPqpSS89WXtaj99BN-7IkqOnS-RDAs",
            "x-proofpoint-virus-version": "vendor=baseguard engine=ICAP:2.0.272,Aquarius:18.0.1099,Hydra:6.0.736,FMLib:17.12.80.40 definitions=2025-05-07_04,2025-05-06_01,2025-02-21_01",
            "x-proofpoint-spam-details": "rule=notspam policy=default score=0 bulkscore=0 phishscore=0 clxscore=1015 spamscore=0 suspectscore=0 impostorscore=0 adultscore=0 malwarescore=0 classifier=parse_limit adjust=0 reason=mlx scancount=1 engine=8.19.0-2308100000 definitions=main-2505070142"
          },
          "attributes": {
            "uid": 1074
          },
          "from": "Denny Redel <denny.redel@icloud.com>",
          "subject": "",
          "date": "Wed, 7 May 2025 17:04:05 +0200",
          "to": "Denny Redel <denny@redel-aisolutions.com>"
        }
      }
    ]
  },
  "connections": {
    "When clicking ‘Test workflow’": {
      "main": [
        [
          {
            "node": "setScriptUrl",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "AI Agent1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [
          {
            "node": "deleteRows2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "isEmailPrivat4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replace Me": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets1": {
      "main": [
        [
          {
            "node": "Replace Me",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent1": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Google Sheets1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Google Sheets4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets3": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request1": {
      "main": [
        [
          {
            "node": "AI Agent3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items3": {
      "main": [
        [
          {
            "node": "Wait5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replace Me3": {
      "main": [
        [
          {
            "node": "Loop Over Items3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent3",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "AI Agent4",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets9": {
      "main": [
        [
          {
            "node": "Replace Me3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent3": {
      "main": [
        [
          {
            "node": "If3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If3": {
      "main": [
        [
          {
            "node": "Replace Me3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Replace Me3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets11": {
      "main": [
        [
          {
            "node": "Loop Over Items3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent4": {
      "main": [
        [
          {
            "node": "If4",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "If4": {
      "main": [
        [
          {
            "node": "Google Sheets9",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Replace Me3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request3": {
      "main": [
        [
          {
            "node": "HTTP Request2",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "HTTP Request2": {
      "main": [
        [
          {
            "node": "Code1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "isEmailPrivat1": {
      "main": [
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replace Me4": {
      "main": [
        [
          {
            "node": "Loop Over Items4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets15": {
      "main": [
        [
          {
            "node": "Loop Over Items4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "isEmailPrivat2": {
      "main": [
        [
          {
            "node": "HTTP Request7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Replace Me4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items4": {
      "main": [
        [
          {
            "node": "deleteNoPhoneNumbers",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "isEmailPrivat2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request6": {
      "main": [
        [
          {
            "node": "AI Agent9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent2": {
      "main": [
        [
          {
            "node": "If9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets14": {
      "main": [
        [
          {
            "node": "Replace Me",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent9": {
      "main": [
        [
          {
            "node": "AI Agent2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If9": {
      "main": [
        [
          {
            "node": "Google Sheets14",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Google Sheets2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model3": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent10",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent10": {
      "main": [
        [
          {
            "node": "If10",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "If10": {
      "main": [
        [
          {
            "node": "Google Sheets19",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Replace Me4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request7": {
      "main": [
        [
          {
            "node": "HTTP Request8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request8": {
      "main": [
        [
          {
            "node": "AI Agent10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replace Me5": {
      "main": [
        [
          {
            "node": "Loop Over Items5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets22": {
      "main": [
        [
          {
            "node": "Loop Over Items5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "isEmailPrivat3": {
      "main": [
        [
          {
            "node": "AI Agent13",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI Agent14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items5": {
      "main": [
        [
          {
            "node": "deleteRows1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "isEmailPrivat3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model4": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent13",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "AI Agent14",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent13": {
      "main": [
        [
          {
            "node": "If13",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "If13": {
      "main": [
        [
          {
            "node": "Google Sheets23",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent14": {
      "main": [
        [
          {
            "node": "If17",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets23": {
      "main": [
        [
          {
            "node": "Wait4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait4": {
      "main": [
        [
          {
            "node": "Replace Me5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "deletePrivatUsers": {
      "main": [
        [
          {
            "node": "Google Sheets22",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "setScriptUrl": {
      "main": [
        [
          {
            "node": "deletePartnersByCompany",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "deletePartnersByCompany": {
      "main": [
        [
          {
            "node": "isAlreadyPartnerEmail",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "isAlreadyPartnerEmail": {
      "main": [
        [
          {
            "node": "deletePrivatUsers",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets19": {
      "main": [
        [
          {
            "node": "Replace Me4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request9": {
      "main": [
        [
          {
            "node": "AI Agent15",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replace Me6": {
      "main": [
        [
          {
            "node": "Loop Over Items6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent15",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "AI Agent16",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent15": {
      "main": [
        [
          {
            "node": "If14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If14": {
      "main": [
        [
          {
            "node": "Google Sheets24",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Replace Me6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets": {
      "main": [
        [
          {
            "node": "Loop Over Items6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "isEmailPrivat": {
      "main": [
        [
          {
            "node": "If15",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Replace Me6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If15": {
      "main": [
        [
          {
            "node": "HTTP Request9",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items6": {
      "main": [
        [
          {
            "node": "Wait6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "isEmailPrivat",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request10": {
      "main": [
        [
          {
            "node": "AI Agent16",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent16": {
      "main": [
        [
          {
            "node": "If16",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If16": {
      "main": [
        [
          {
            "node": "Google Sheets18",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Replace Me6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets18": {
      "main": [
        [
          {
            "node": "Replace Me6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets24": {
      "main": [
        [
          {
            "node": "Replace Me6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model2": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent9",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "AI Agent2",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "AI Agent1",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "AI Agent8",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "AI Agent7",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "deleteNoPhoneNumbers": {
      "main": [
        [
          {
            "node": "sortSheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait": {
      "main": [
        [
          {
            "node": "Google Sheets3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait1": {
      "main": [
        [
          {
            "node": "Google Sheets11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait5": {
      "main": [
        [
          {
            "node": "Google Sheets",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait6": {
      "main": [
        [
          {
            "node": "Google Sheets15",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If17": {
      "main": [
        [
          {
            "node": "Google Sheets25",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets25": {
      "main": [
        [
          {
            "node": "Wait4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets2": {
      "main": [
        [
          {
            "node": "Replace Me",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets4": {
      "main": [
        [
          {
            "node": "Replace Me",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "isEmailPrivat4": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request5": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "HTTP Request6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent8": {
      "main": [
        [
          {
            "node": "AI Agent7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "AI Agent8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent7": {
      "main": [
        [
          {
            "node": "If2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If2": {
      "main": [
        [
          {
            "node": "Google Sheets5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Google Sheets6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets5": {
      "main": [
        [
          {
            "node": "Replace Me",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets6": {
      "main": [
        [
          {
            "node": "Replace Me",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code1": {
      "main": [
        [
          {
            "node": "AI Agent4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait7": {
      "main": [
        [
          {
            "node": "isEmailPrivat1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "deleteRows1": {
      "main": [
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "deleteRows2": {
      "main": [
        [
          {
            "node": "Wait1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "sortSheet": {
      "main": [
        [
          {
            "node": "Send Email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Email Trigger (IMAP)": {
      "main": [
        [
          {
            "node": "If5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If5": {
      "main": [
        [],
        [
          {
            "node": "Extract from File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File": {
      "main": [
        []
      ]
    },
    "Loop Over Items1": {
      "main": [
        [],
        [
          {
            "node": "Replace Me1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replace Me1": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets7": {
      "main": [
        [
          {
            "node": "If6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If6": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "3ead3479-7e05-490a-89a7-0eae54cf615b",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "ed4f3f37220443d82fec76dc79b331975281d2af5e70e3db9bcbd487ec78ae41"
  },
  "id": "eViZK2C8sOY5IlaG",
  "tags": [
    {
      "createdAt": "2025-04-16T15:26:40.409Z",
      "updatedAt": "2025-04-16T15:26:40.409Z",
      "id": "xMJG5qRMeeuaV91k",
      "name": "Niklas"
    },
    {
      "createdAt": "2025-04-16T15:29:17.672Z",
      "updatedAt": "2025-04-16T15:29:17.672Z",
      "id": "idviBckxAZ8HLBc3",
      "name": "Final"
    },
    {
      "createdAt": "2025-04-22T19:50:23.819Z",
      "updatedAt": "2025-04-22T19:50:23.819Z",
      "id": "1abeI4GcY43z2bnA",
      "name": "K&S-Media"
    }
  ]
}
